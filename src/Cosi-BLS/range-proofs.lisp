;; range-proofs.lisp - blinded value range proofs
;;
;; DM/Emotiq  02/18
;; ------------------------------------------------------------------
#|
The MIT License

Copyright (c) 2018 Emotiq AG

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
|#
;; -------------------------------------------------------------------------
;; Compute a value range prover and verifier for use in validating
;; cryptographically blinded numbers. This version proves each bit of
;; the (integer) value. It produces a rather large structure of prime
;; number field integers, two per bit of every value being attested,
;; plus two more as cryptographic basis vector components for the
;; Pedersen Commitments offered for the value.
;;
;; Algorithm adapted to ECC crypto from the paper:
;;  "Bulletproofs: Short Proofs for Confidential Transactions and More" by
;;     Bunz, Bootle, Boneh, Poelstra, Wuille, and Maxwell.
;;       https://eprint.iacr.org/2017/1066.pdf

;; The code in this module now uses Bulletproofs for vector
;; dot-product proofs. That saves a considerable amount of memory.
;; Using Curve1174 with 252 bits per compressed ECC point, the cost is
;; roughly 1.4KB per proof, compared to a cost of 5.2KB for
;; non-Bulletproofs, atop an overhead in the basis vectors of around
;; 4.8KB.
;;
;; This code currently only provides list aggregation of proofs.
;; Algebraic aggregation will save even more memory, shrinking the
;; cost dramatically with an O(Log2(N)) cost on N-proof aggregates.

(in-package :range-proofs)

;; ------------------------------

(defvar *max-bit-length*  64)

;; ------------------------------------------------------------------

(defun rand-val ()
  ;; random value in Z_r
  (random-between 1 *ed-r*))

;; ------------------------------

(defun zero-vector (&optional (nel *max-bit-length*))
  ;; create a vector of zeros
  (make-array nel
              :initial-element 0))

(defun bits-vector (n &optional (nbits *max-bit-length*))
  ;; convert a value n into a bit vector. Each index into the vector
  ;; is the i'th bit of the value
  (let* ((arr (zero-vector nbits)))
    (loop for ix from 0 below nbits do
          (when (logbitp ix n)
            (setf (aref arr ix) 1)))
    arr))

(defun random-vec (&optional (nel *max-bit-length*))
  ;; construct a vector of unique random values
  (let ((vec (make-array nel)))
    (um:nlet-tail iter ((ix 0))
      (unless (>= ix nel)
        (let ((g  (rand-val)))
          (if (find g vec) ;; prob vanishingly small chance of duplication
              (iter ix)
            (progn
              (setf (aref vec ix) g)
              (iter (1+ ix))))
          )))
    vec))

(defvar *digits-of-pi*
  '(3
    1415926535 8979323846 2643383279 5028841971 6939937510 
    5820974944 5923078164 0628620899 8628034825 3421170679 
    8214808651 3282306647 0938446095 5058223172 5359408128 
    4811174502 8410270193 8521105559 6446229489 5493038196 
    4428810975 6659334461 2847564823 3786783165 2712019091 
    4564856692 3460348610 4543266482 1339360726 0249141273 
    7245870066 0631558817 4881520920 9628292540 9171536436 
    7892590360 0113305305 4882046652 1384146951 9415116094 
    3305727036 5759591953 0921861173 8193261179 3105118548 
    0744623799 6274956735 1885752724 8912279381 8301194912 
    9833673362 4406566430 8602139494 6395224737 1907021798 
    6094370277 0539217176 2931767523 8467481846 7669405132 
    0005681271 4526356082 7785771342 7577896091 7363717872 
    1468440901 2249534301 4654958537 1050792279 6892589235 
    4201995611 2129021960 8640344181 5981362977 4771309960 
    5187072113 4999999837 2978049951 0597317328 1609631859 
    5024459455 3469083026 4252230825 3344685035 2619311881 
    7101000313 7838752886 5875332083 8142061717 7669147303 
    5982534904 2875546873 1159562863 8823537875 9375195778 
    1857780532 1712268066 1300192787 6611195909 2164201989 
    3809525720 1065485863 2788659361 5338182796 8230301952 
    0353018529 6899577362 2599413891 2497217752 8347913151 
    5574857242 4541506959 5082953311 6861727855 8890750983 
    8175463746 4939319255 0604009277 0167113900 9848824012 
    8583616035 6370766010 4710181942 9555961989 4676783744 
    9448255379 7747268471 0404753464 6208046684 2590694912 
    9331367702 8989152104 7521620569 6602405803 8150193511 
    2533824300 3558764024 7496473263 9141992726 0426992279 
    6782354781 6360093417 2164121992 4586315030 2861829745 
    5570674983 8505494588 5869269956 9092721079 7509302955 
    3211653449 8720275596 0236480665 4991198818 3479775356 
    6369807426 5425278625 5181841757 4672890977 7727938000 
    8164706001 6145249192 1732172147 7235014144 1973568548 
    1613611573 5255213347 5741849468 4385233239 0739414333 
    4547762416 8625189835 6948556209 9219222184 2725502542 
    5688767179 0494601653 4668049886 2723279178 6085784383 
    8279679766 8145410095 3883786360 9506800642 2512520511 
    7392984896 0841284886 2694560424 1965285022 2106611863 
    0674427862 2039194945 0471237137 8696095636 4371917287 
    4677646575 7396241389 0865832645 9958133904 7802759009 
    9465764078 9512694683 9835259570 9825822620 5224894077 
    2671947826 8482601476 9909026401 3639443745 5305068203 
    4962524517 4939965143 1429809190 6592509372 2169646151 
    5709858387 4105978859 5977297549 8930161753 9284681382 
    6868386894 2774155991 8559252459 5395943104 9972524680 
    8459872736 4469584865 3836736222 6260991246 0805124388 ))

(defvar *chk-digits-of-pi*
  ;; = (hex-str (hash/256 *digits-of-pi*))
  "FD9743034DCCFBFAC2D24BDB02983754D5632D865F63CB14BA3410C41623A86E")

(defun basis-pts (nbits)
  "Compute 2*nbits+2 ECC projective points based on successive hashes
of *digits-of-pi*. The first point will become g, the second will
become h, the next nbits pts will become left vectors and the final
nbits pts will become right vectors."
  (let ((nel (+ 2 (* 2 nbits))))
    (labels ((gen ()
               (loop repeat nel
                     for h  = (hash/256 *digits-of-pi*) then (hash/256 h)
                     collect
                     (ed-pt-from-hash h)))
             (no-duplicates (lst)
               (delete-duplicates lst
                                  :test 'ed-pt=)))
      (let ((pts (no-duplicates (gen))))
        (assert (= (length pts) (+ 2 (* 2 nbits))))
        pts))))

(defun pow-vec (y &optional (nel *max-bit-length*))
  ;; construct a vector of powers of y #(1 y y^2 ... y^(n-1))
  (let ((vec (make-array nel)))
    (do ((v  1  (m* v y))
         (ix 0  (1+ ix)))
        ((>= ix nel) vec)
      (setf (aref vec ix) v))))

(defun ones-vec (&optional (nel *max-bit-length*))
  ;; a vector of 1's
  (make-array nel :initial-element 1))

(defun twos-vec (&optional (nel *max-bit-length*))
  ;; a vector of powers of 2: #(1 2 2^2 2^3 ... 2^(n-1))
  (pow-vec 2 nel))

;; ------------------------------
;; Vector arithmetic over the modular prime field

(defun vec-decr (v k)
  (map 'vector (um:rcurry 'm- k) v))

(defun vec-incr (v k)
  (map 'vector (um:rcurry 'm+ k) v))

(defun vec-add (v1 v2)
  (map 'vector 'm+ v1 v2))

(defun vec-sub (v1 v2)
  (map 'vector 'm- v1 v2))

(defun vec-scale (v k)
  (map 'vector (um:curry 'm* k) v))

(defun vec-hadamard-prod (v1 v2)
  (map 'vector 'm* v1 v2))

(defun vec-dot-prod (v1 v2)
  (reduce 'm+ (vec-hadamard-prod v1 v2)))

;; ------------------------------

(defun poly-dot-prod (poly1 poly2)
  ;;
  ;; Produce a dot-product polynomial from two polynomials with vector
  ;; coeffs. Polynomials are vectors with element at index ix
  ;; representing the ix'th order coefficient. But these coefficients
  ;; are themselves vectors of prime field integers.
  ;;
  (let ((vec   (make-array (+ (length poly1) (length poly2) -1)
                           :initial-element 0)))
    (loop for v1 across poly1
          for ix from 0
          do
          (loop for v2 across poly2
                for jx from ix
                do
                (setf (aref vec jx)
                      (m+ (aref vec jx)
                          (vec-dot-prod v1 v2)))
                ))
    vec))

;; ------------------------------
;; Pedersen Commitments

(defun simple-commit (gpt hpt blind val)
  ;; commit to a value val with blinding blind*Hpt
  (ed-add (ed-mul hpt blind)
          (ed-mul gpt val)))

(defun vec-commit (hpt blind hs hvec gs gvec)
  ;; form a vector commitment with basis vector gs,
  ;; blinding vector hs, and blinding term blind*Hpt
  (let ((pt (ed-mul hpt blind)))
    (loop for h across hs
          for hv across hvec
          for g across gs
          for gv across gvec
          do
          (setf pt (ed-add pt
                           (ed-add (ed-mul h hv)
                                   (ed-mul g gv)))))
    pt))

;; ------------------------------

(defstruct range-proof-block
  ;; curve and basis vectors
  basis   ;; should not change between blocks, so common public info
  proofs  ;; public values
  sum-cmt    ;; sum of commitments for this batch
  sum-gamma) ;; secret value = sum of gamma factors used

(defstruct (range-proof
            (:constructor %make-range-proof))
  ;; commitments
  vcmt acmt scmt t1cmt t2cmt
  ;; parameters
  tau_x mu t_hat
  ;; left, right vectors
  dot-proof
  ;; challenge values (Shamir-Fiat hash values)
  x y z)

(defstruct (dot-prod-proof
            (:constructor %make-dot-prod-proof))
  u pcmt a b xlrs)

;; ------------------------------

(defstruct bp-basis
  curve nbits gpt hpt gs hs)

(define-symbol-macro *bgpt*    (bp-basis-gpt    *bp-basis*))
(define-symbol-macro *bhpt*    (bp-basis-hpt    *bp-basis*))
(define-symbol-macro *bgs*     (bp-basis-gs     *bp-basis*))
(define-symbol-macro *bhs*     (bp-basis-hs     *bp-basis*))
(define-symbol-macro *curve*   (bp-basis-curve  *bp-basis*))
(define-symbol-macro *nbits*   (bp-basis-nbits  *bp-basis*))

;; --------------------------------------------------------------------------------------------------------------
;; for 192 bit security...
#|
#|
;; Constants obtained from:

(with-ed-curve :curve-E382
  (setf *bp-basis* nil)
  (make-range-proof 15)
  (with-standard-io-syntax
    (pprint *bp-basis*)))

;; then copy and paste into here...
|#
  
(defvar *bp-basis*
  (make-bp-basis :CURVE :CURVE-E382
                 :NBITS 64
                 :HPT #S(EDWARDS-ECC:ED-PROJ-PT :X 8612201293566734223588214747479929632715945648026515596982370269371032093827903093265729455403366112858677203832324
                                                :Y 1821798114335460303565536055342256524288679912211827130039032798322694849824110155707270855794041260417230591718638
                                                :Z 3057880493205124016415249835654380727692427883468021670259055934455824037910150821100059140045666675238527172125029)
                 :GS #(#S(EDWARDS-ECC:ED-PROJ-PT :X 5332639936434734650003747019746075753458135492755734981532663040983591077204897241150077468398462111163237533084740
                                                 :Y 3542688767209110274517396076140643299464619549463347635805964231103854148297861757426608419861271418311716030286857
                                                 :Z 7764447255252589797048739719225562154479580406607213770108715247755474047055609435335127026457360375960056083307210)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7377930852289797863727046610229289130216756684038810408288205005520740688503346903082039874058863494180331839152470
                                                 :Y 5548642525911682434496221412757661435674849082088309105430477991022740058079980558735939730026182585576067614043671
                                                 :Z 5156495191280660529824009844462631022199639853690181071724403084400315333588472778982403722273234466157210871672221)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4237216169021218580515104842060728003621087613869087533566397846020827623685208063927369893010812890103584717017316
                                                 :Y 5028678919754484567380522181247793286487194045616039419128158105287940126867542707084432044113774009483766652504834
                                                 :Z 2217934928736174653419936875652951171434344023378320936417250497795855635782006023753222554252844812712660177876609)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4177526857554896763658955208847485886214467161756728590334554743810060660606558595711884161083672636217887600056952
                                                 :Y 7582874530560236923529876559282323988175131475035466158542997717224614454080718248367230426236784368344800709464255
                                                 :Z 6051064635132938077567973329912769251397857808791052324226661322517506765058166549532836819410966405257770808395196)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1090606546638165138903320600847780762526748703194020754435043947562839857786259610359042006461129909898186022415630
                                                 :Y 4850862830779381209445282752819570568801149700103926095566209004365561983022545055341150392473734912995089971170546
                                                 :Z 2641467302265469471426872570809501498598604612065534219635413686798004297173355965965811199160334978401001373738076)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6042877557748199407587173084647574134393753767023470517785547520705122194311444098962611122976577635895189667728095
                                                 :Y 4556238393606557057416962011020630740068955360755862571110830366362975254504245478294905530676470014684558559852311
                                                 :Z 5666826108386650951990840594863447521731371513228909772641704735415886108748580242022550482022491945037903013761049)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8713257564118155301921570569692065733212041524981906324810600976832991230680046674021766789374756654273639948378031
                                                 :Y 6648138229588087282532696582500025188289903216924207834189839979576359895501034462327295643699826557649446766508429
                                                 :Z 8044905866959214190196851306932417761178473000526084151156653945419954670625386024136743064458627003788437574045606)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7953484092696033884642099862343784027179669760402361676648633069366265355125980908859745575386374528577103864682989
                                                 :Y 4998568709079821000680290007505075500332944216131770253595930032632689945361507506593291939118691315720893393773221
                                                 :Z 8919396237528788035468607178719222741807820630120821496095324624613594324157426226510583782266831039318986205378418)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4851249361304453365768997112010401634017036122802971762031189855349930671182432493124632515090666182485985207855992
                                                 :Y 5186524440699423204308886592832416245110523262038820512454249355030983270494478592879960269911027600199056714698485
                                                 :Z 1575270292169957961096186888549784038851532094422215236595322878569423384173019640164835446820453987249124098878714)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7278202269367814038300555817102744170827342679662705390005972978401682448262464098202471756725280971677346517048167
                                                 :Y 7207400261926304532701435711447094337401668260086667965252400899835465165284578998420614052951795363199431652490434
                                                 :Z 2549152684722625066383287783802804287072022516272626462714731954687447619838630081493582713845961095583867232072481)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 293194329009802618161281248007701300596887818549623930641440760802343511315046966258852306150762765527007165948748
                                                 :Y 6522758405772814728192076635698982724390887620733016344485404080301503632793045285065421800530108165983230240246606
                                                 :Z 3773142279678417960929900135159200195964484925194451783785355568755196571718823034563899585733772845047418470442025)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4498440663751384209876269606954833148569096035982676273191067040556765816974908548634117665682128995779977312044082
                                                 :Y 9678034746256250661761976072878235217666285167600217872155629278450419798827772807087820579503254787608445447394368
                                                 :Z 7017634370569239158254698918036240573742073554385280191857858984612828508165381892363915759859635143767500486812853)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9810804353652874344447195687218095985255369397442294914962097468262444327400199649498092501364708854256555066421860
                                                 :Y 7873137081079944052332587606658744127484121945523952766362581264075438784266623197464127468342482613893755483607226
                                                 :Z 8665993104991338380935451458844451828545496033747942428473120985036911986154849668644160642055156745373220902163158)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7498534976285217469573605684708199921908255493928313605911104354240469101711386172536324824801639579916336938902430
                                                 :Y 6270479449823564931136215970831658964069175921455042527404048382011477661308189894152672973476219428811270298536796
                                                 :Z 7551476038204566889269095164643876549369265437800662777945055325014474413417558771486247079292202783948245294229760)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9481582439343160572930079390519983252804512065134875746024967345217387920046922042537550522171091386648176464522526
                                                 :Y 4393249638377952308817609150163682952224526706760122254927845277157100901981667906952602731719981013137826826590361
                                                 :Z 3132174820360214182407151710114069680401066678488268867141805216891302851098395570271005876182136737226664897814887)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4602872105592588151978557148623500547540192599751748662800254608890029774281886417407525239703857023441343926799742
                                                 :Y 1637246001435292300694452995029406705303299064787895044689003243228402305455416513291269188341935737986129460990963
                                                 :Z 2934363089242389616025814691021220004817071319697894933775580112204588613456149962040245038455534039771875922585315)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1544017297538216099328824905119241799806076234681349578808415247006575379565924087056815611744383626057779218089524
                                                 :Y 4800035572566775763301816850477741847251537482690059242084093438692195451233876943793659257542469029925817091042648
                                                 :Z 8224087583328525541656757587132964642546489256943980947496305330785365740027050520469780319582983506006225728164160)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9350781908569776841264304475183334827479001414008616892110060732147669514096896822337826713745311250859387296549416
                                                 :Y 4261614497367850005331260604093121388922101239269404700140232114231735693923437343459924791029258390515156340681862
                                                 :Z 6717852002646804563735701568597273262494673609924893671833793639402885211680760648541347315033007643685063246686522)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7292504091164799995922555229692627175558389741733708938117368956157936239323027131904499834898164975990252276738731
                                                 :Y 6894835634789741203801171332292042351833263416643062182175923802878215692294900178781605391343524495385130986586598
                                                 :Z 5460501463269564985046313069452922634003037774932399771523556853075285555182074399718753011511916226876740904666609)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8591589002349900148417810272072429440612654580755340504434876826620368430414253184758129777660133251683740926461355
                                                 :Y 6848258219341358506934089942831351306046832357723689886983360422126190966472900283377053178165200845483094053495568
                                                 :Z 874775590524246876880045848363724213819138259580455916394336995438993536719044813544841065969099895194551602517877)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8946015416877768869760256351987184757568217389807618294149959510696235432555630765562780439455552366468032405882166
                                                 :Y 3770487864264804424226017050763922914071906110450199165411160493246764809300142362451765488987165419188686495291996
                                                 :Z 5186085276986158598414648523104124176721766209718938263334398671899242733419725177995370134253557393513792719354938)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9735864629640415247445995103377368431677533514171454440121719791944153332828107279756599364561906297233181714539554
                                                 :Y 2213605301297979417723995502727328856496737466341281844813093195587274022745375503334357609581031599909825042525989
                                                 :Z 1853607599396889732227686987342614836904781256575847635956717111786925043576308431303699586628615257045730238031565)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2790944577195098664534343083275596853964283531850452803806209928643384477400593428542559366715449353547406530928020
                                                 :Y 8863500113614699565342847805717389255690174136735685531809089128700702245704304911525093884391293238836979729079319
                                                 :Z 9288355768539489214612052887805721570599426626606271943348394304854441785554979638965359627770449293014205469332215)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5864968224010058727818258295955048034027099871336439495383705048195913006091114634087298262639225913162953663663444
                                                 :Y 2269646001981184034143442832131500267743595739613568330843632618881936821170151677766055453093163418292294454906207
                                                 :Z 3810463133738795806293619002393285286632928539487794685055174065996490956600748781944232410744475597444686270254444)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5309536691786364528806731857491072061697612030411086020263895820903194819971380042848311562955926650230021395144411
                                                 :Y 247383457527611267093995361768469187922175779146024602786889721978555546888858286858182073784344156508868507069303
                                                 :Z 4990989882080130649838937296878832489578418948880402112906483063235768354082982056665292464559153925850582450729963)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 984002294658949831814104382805448030969065919549285439184594816568092781929850626394455724205004000223262566862347
                                                 :Y 3316955461227516034076404206254594843532046998201860006834449617290864360772433336042955643799961149342192663145626
                                                 :Z 1289012006582370654105887303116295625628780317123962549574922252445997434117718386389763452807323532348566111763330)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7285801354867917077055793813717514193746643541006036470295857162185778375810221574128426852277131241509829061032630
                                                 :Y 8671949533976758647140073139126721925738934932963714404408088225765415469992791820316289180211905149182508610198056
                                                 :Z 5380184494236264060432343756427349072898446054483371931494508845090808094342577171002933812626977490730852540157252)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1344741195980537348525883825789180370108832994460031160221176817664049137794599496037433045822324003647773303985567
                                                 :Y 9708690849402791125184754780241271475847122230549310015448196786865903369575853404170723609577232282921366310395684
                                                 :Z 5211372126671240731314934122866425232534678864918981672128460012101218949000139265713577656267359741516698466598181)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8959694316187273276946628086291335281741751085832567794902910260816629666668245780431856188105023725143924104210820
                                                 :Y 8523916052209094996080949077687296031112109691149243286076896224890236049187042781538847833468118921872177754630377
                                                 :Z 814777946374487264284856033190474573082783243675237452126640359884713981792010648938484141517614630561969811689030)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5446305339926801628409387114805014236252480751005942066537329095332568306965099484897420993477942058171892426124072
                                                 :Y 8758725180414593506719723592839272894029462805550949457859970673731418272924179184484950210119736693437723483384201
                                                 :Z 811876942037678646597340214311680031988702854976358940385140941486287135950714851668289364682160492755563324097099)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3033848247664992967055811594109523337417004591380035050717060025571343832447897636479896875184768370896264288725023
                                                 :Y 2306111494586102468552589881235719721061828757549057312052343398609505285945024289792451346650629658861356472188229
                                                 :Z 2948254177494698203680481006344523377305783219704769421328427612251065673945470749497853130365391831511946494220526)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2927365110782389902780857281870888030094432716417131989855203260507365228265236212874184659339606505343706364000165
                                                 :Y 6941455983746364849453255096718875923610705047347091801798397365451638176472474739732195516452738809235118356980876
                                                 :Z 4423167684157189309966156047372471758600470509784993338921484669606319079679365550690549895331312438600795003988699)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9285682479130375182952229265057897684607072250721213878307521155578853792985302109679939025275008901136610199417236
                                                 :Y 8725211807735505366055596050805551434689968993311063387161257003072849971724386396382662108534449367465544784235433
                                                 :Z 2724499387147279156118158576026379247513880819038530687303468929961120733749504673297955612249585445990930382599582)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2945679407749803360608850150357175872299960548703502414156661673101164516267793009730617411906141320534464731018983
                                                 :Y 4251594239919160756602871002509934914139367607025799359405228063871161839831236542577700148445630153572113525111065
                                                 :Z 4606239557926223629479614013867020018783533833332524590013260719510384622381140356421290709096388836985741313564389)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7469831197037439935651742346242113211988018351493038194873429788507192765388523074975115055599204842296121576795207
                                                 :Y 9148549985856168253273936149154997270798138933815294540939976134023981340279486516046194269732193525309626563336054
                                                 :Z 7236384812128295612027398213059207063000172783286676032537160176039845819465761868401784328478691092509015683416604)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5644080402524182823888598267909509141231185376292234500732069822161597792759612183615787985758011206724122870316088
                                                 :Y 9782713751150897270039500528396375281213425232026897208606935610355109090777580191377418184676682957882309723440806
                                                 :Z 1747906358883573948572776106831797346807288248313411477099525704567771290319649941111274403810042667990962402228181)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8282330169742083942323615348675899668625302579520096796839748432773526856153002818998000602111940050385833387524053
                                                 :Y 8011365725382712465026077701647373659469145597353609440283445151786991946141807884043413792719413034222581086705161
                                                 :Z 6145089035692199456668368844828851953158986260511680319580528526543999386536274758813612949999464571691058616551863)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3894702173429007149336186547193718129258520723198272361358498181610801817391576928963633559087778939590666432985952
                                                 :Y 8424927364266159088057972510590550028374346121618164023164805152912294280865045705010608161305457340532656367767334
                                                 :Z 3348241727156047358689682083105294456143215754299835848776555455066370622651447231726811661013469825634997430493321)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1670717049115409006295640259105389137030398309208416531135827815112571000310828683797554830168986954367053594219289
                                                 :Y 229254363684846550599222364485344003121307814849838604365317641132235826078654131059300425581808847214327367085028
                                                 :Z 5160175707511230812522493722086412678673699218322865203401798754859583238598308136720266348514314179820262011409769)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 688789018700988963351795020840215329524942463766205259176687915727510695966349540532779620834612391003816447342688
                                                 :Y 3448969475958042054448565737677526318261181118454504917977595070283120345675102980313662612202667248789804048565305
                                                 :Z 3582254835564997298671285100967404398397102642098288508270861030866770335173178551056412642243933443698218646605823)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9212896238989146726792227844313549934261930161431401215134259529919129055092160204235494214412733032938058696898652
                                                 :Y 4475004344929599251584604675551558017168960198871954148909934931883561351361131157495451077738884244119307031780132
                                                 :Z 2935361639801648004126152369374327260714471936908118453649041205754886817790077331040965343734202526509225819658305)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 586978321296623466883129617855624172179625975244027171022567251235174535246950792225994623836550692167079815984390
                                                 :Y 4438905254787881723571373107875966782491811767915531857269499958849043703246065833159852673108899297538990755826278
                                                 :Z 9414907735561704165845482710583595530132675213093726566240097096353333092487351557271686774664167955978671158086176)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1902454132045801452327414063310322195094514403542120080150630669242462349881535186874333106931413515745470505434906
                                                 :Y 5876881409129915703930645677757634847363954902856866379831710468408020241117993539755457104669997227270840192549190
                                                 :Z 1269738949275193647250978029588564906212970034490172922989146240979887333694415952649020236791301354668398159169448)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5042319831348627169490150194923265503153955254808801519906433144726557245213799564073495531389047860787411077732945
                                                 :Y 1138676610530226370139395231480765786846754160545118827549849498189531108846579273373211632224511473530810249367838
                                                 :Z 8209850683474055000523818930966571514058230069805567491597424174699762637395656855931405810695311819389738490182677)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8438938032576312161343387993680882803432574920191348257409872536793708091515712548417258228952647097632084545860360
                                                 :Y 9027763457515123115000038333489757422556657865434418365537479682927923136110294711411314650178473830159569536485722
                                                 :Z 8807988243640870025975153166449226654219406011983152778310476351574436885425206866633006911991744526353685177586627)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1796597760423284425654815557004831334225377840683039767243897926238358666073652097560474152257694713328190906580870
                                                 :Y 731916953725088178281564428115452152241109697705934159061758475959296171684196535265709530096933434539784453482365
                                                 :Z 4007479340699251998622086716442160366674653156908907851034430805060104972610136416115391488672936495599909874774797)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9637171064921378870176785228099183924743157740072304299915812330110241241171241894197044878459098830855481026904298
                                                 :Y 200911417086927446466468507986364168180304627101726828529156872040442970022688868701902278229863077382118522680258
                                                 :Z 3237961519980200572601175351298796133824437477110949912071388144856916180385937316299634852968266693278771561594715)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5941359948363434625453561407422405982693051857185454611982454524309123858631195628695629156840771643827496017151195
                                                 :Y 2127568428834799357200403455778605825605752572644947829991933853941434164399769822634848790954788561711753441755966
                                                 :Z 5632655103856380410954148429818675207910480545051808949342058004253443535335640413656793037947415928870748249666823)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9198034887177069598878343511722786070008244227079703251573388093357224940417659719293591273708489646060134259902048
                                                 :Y 5786702009516341851061096828179378796355826100275697967833461913339846348916767245641674146864292223557062714264860
                                                 :Z 3038988728444879562879525151330260743273267231856301798867480309681138999524503502543653544374455374203343889783887)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4723520197966921659126127754897739179516569485763937570201158794411631589807726676950502448971034266048946894698316
                                                 :Y 8837663715311713348768181703656887188781564424810546688646147350177559030406826758951221998586524598617042243737250
                                                 :Z 2073111587967898808160920124446089028398985145825831881786413228408530679569878907580087842252163970292752820279973)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6937529043525884598573465956992381480519411208896192974396235541083064864997643121346659334520271629499856992711451
                                                 :Y 7780966657772999736086438767353403381211889796866546012015604262146151920452440368720773787541423473504002006368622
                                                 :Z 7863896091036310832352071058954087502992830808932257941652028257661785373561971194871168543221254339799002542467755)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4642391413495113110872182026058636791002621173888041414420431331338690692445641343836109122876471128332937969387318
                                                 :Y 1599559060636551127396292378712398327238953762594311473998477603478290690727099177047552206518681437467499974776995
                                                 :Z 8354433248294417944947851287656256740058712656962714687452882738974253189322646508986132510641924658542490349332219)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5814026654431104587086294343412101640620700138051699590663360708559447414410450890078152651282388216676566942569842
                                                 :Y 1085124483826405604051786968236767188741693536429672775341369544615205306033793218956045342664023498353577974672812
                                                 :Z 8588014001389282005686830345957828158494233580482192780345108356264458241494014862803676311355024649852398888398047)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6688902256133423196281170751526542735844195892724159169348600068475643559608981121182174334542857941536519947067757
                                                 :Y 6006942152289892342225117494910682909266304543899314195154451197024155630665455875566356970217835673766776944191305
                                                 :Z 2629824140163587535238340147529780098133982648747615871312215308910785738038061647112294002564318331879282315282659)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5705840258845451198646377208057388793619083620449161247344537598920126972813428040668387269995115996858029768432670
                                                 :Y 6425512891005514303657276370062104111071251554169402887927367702479171722051521491382119651711725597353337785841186
                                                 :Z 3867996706400161864966994489731702511611999729216749433766510465057522079577681263126491659020295033530127338173093)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1679455435710182444982005676080998659748183436754113173223767932400611779931215996611977404381299902727527102743367
                                                 :Y 3764001977653011133037650942362457838067366755010269653671812362022430171150222840288916048972979115935015651483026
                                                 :Z 5531309971193991403366199102338201856833482914085667163682832526843002256565666364651930549796845793748393812879393)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 996974520840141970625118232854864295239296234740254041175268795946332343493648251450296820743751416835596802775552
                                                 :Y 5928349194596980130182047575407239358737653327564761898596401689740790911823356171275093565409841024827927026939533
                                                 :Z 9276979850887473976181453826918953715238786313663884710606744649173294973479737701596602257715429356445503122556498)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9121366292706491564849093092762883495957978728358731384147115954209016026371047822068592423277172270846314126977558
                                                 :Y 6107638013440738826422631871312737164314898983771842974753474446875558071397865923678264100706185664611015992525908
                                                 :Z 1613276766008270371033235397312465452422031677016409452677046532318788970868488946704837299084135009111499042097008)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9261756852094888242473511872472733284353238923502294501849761044451500621408633735880879409097975188331113213736355
                                                 :Y 7028757741845041783793812371888582331807395239351967198002893075616196234616040779080166343254870015903588475389287
                                                 :Z 6947699550703962449405639741807165799391066227712880957085244740806633203563542821214544849947693957523368510103275)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1701265229819915538909965688223793305904003840564287359310948811477986949208901292532722711321704671351504908218630
                                                 :Y 298021540832212140367732744313460546022368202870770285469610903892053260393993285244389163215237146942975960586243
                                                 :Z 5128775590948441623151973071785208040560713949354593170341493681349932720318096255614837894343009936768561706795483)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1062144640463997698795068976562060390813989108190174858337256829774705142070416316121022926205730304694744574719182
                                                 :Y 8833859321548661613015391359767647222516628796341389818663781892363781117090546158503456557309524776748852849167294
                                                 :Z 1884724403745933431992365673823937143871881696124392547295465938776550000431108773603353544996849597300473376953549)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1079225220291989026973586270661037402599790056082792422733169243879226206947922648790882519231691141974773520999255
                                                 :Y 7708649968859442431531929247048272972342406605018409791955901841219466942818928231787118861890695731175969610979731
                                                 :Z 8003070478825258226028870467142892915214320044230998783006768778392980769371953022845181886359590657089292487446151)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2249403129234654620322477508173229761301508543620795333761648774646795495522483969025779963065932676068637340566821
                                                 :Y 2070367385341426401559988192083003653096340615494597240415865916572184484273765923178368663974359106178378742903471
                                                 :Z 1607298133317180086295342766474049603512235749501738347216528402549761428444844245213556265858053224307213728290292)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2271152055611566508493401687345697349868441101367198871444204327803628929260890658038992153957848400920321602273879
                                                 :Y 9303736688363740002574330172796986672185286483408373823523575565883170668733634971271840880395033875821132636608493
                                                 :Z 7451515562997034687530877315500841862009047152535062565493253257417737384655497334011573976638709333543328602384851))
                 :HS #(#S(EDWARDS-ECC:ED-PROJ-PT :X 2558767872928433542484713041964542155808779749898524426240426060408500917159267811904512055422911392040758855817952
                                                 :Y 3173967478909156831285595710873086518983321770077972703399131140281499099251947292627104148679282975236936571464593
                                                 :Z 1480312786342685288446496827672618173995207192044359152587408348579172166879744721333469370060169790616639811724041)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9004968536710126308451716452085651569373160138659146449773822434782327051691992115214603225067375572402873304389591
                                                 :Y 3273460780136502494316735118263990010843004327699746311515921090690348265098596979945435154028978852395637446241588
                                                 :Z 323711638393187583724542755938059247096889337010638278449903893678192997600021671399401739546242403459136492745500)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1602746833881230686455054583527117605954202650639585493272539784063842394349033649761185305808051555137557431070788
                                                 :Y 3382242275773658203301870578416455888040238950957465596507113674817908346656297377651307046031338336718390367655944
                                                 :Z 3361858112448691606136935837906809430389499248488750970253640144497064455371270409020989980634304893400826658528067)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1071106707391275096599489321089341694110478213981225481638105300447950288494108626265235772233129058024327918899444
                                                 :Y 6306069908009725177482440739658470415120621532864554307127944619515428378699880643682527905941023966810611553789623
                                                 :Z 8950838049502621425713878400230238273798082376221833328634151170225512765757360295126308797045779462266012189609013)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3251077677810116379827522502936907539664192164451454805173766103239540726043107117949857022511265084166180160743075
                                                 :Y 1232492934318874915265654400128515162269980342187691270723217887113286927262862163349366850099550671087078041879511
                                                 :Z 9218834951683254553268624801353829014309535203428824526781879028345907082328006591907496751120715784463123569950017)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2605862575773012917170988780797419136215260465620441735510493887603421490367218122637159013697267160721159035934386
                                                 :Y 6238128695884706547099448794026770534244967157800210494283990099953774410356497223440126234133405320044526669257501
                                                 :Z 7674899844117982837606477798349794530952033879463373737590097898879231879817177251059789373935454651472028520280246)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8091452050155752419613043559224922519108015268098960596493615396686579601329079333707308985942739540136547066047329
                                                 :Y 6160813498944186038744340250365834212399363436600199792243004620376679927393498292142219899506869321943255044796907
                                                 :Z 4142134441309337313897604055555329437842433710878475654334971124830604518683120804545898912037185234897807852949066)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4308168757164360785523312054397121224083778610464385816231884081538864198043047592540902863559464545273382213279670
                                                 :Y 4823841762439225821939864647722692718164441199157181138698887901931637293214793086095089020085536947361760919413672
                                                 :Z 8460583815138175439695597602040787010392419184562193769011710110949997104274068361891597316433578553814447537676112)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5466213535897700289989991917195749827542663933205282615642165373077583485313185598487622253944245009008884881331018
                                                 :Y 9256589863082311584942446198430483441877543536197816413152929627027415802130672639138105805363812318979373847702168
                                                 :Z 5107613997293389697897202756112447296763734992632387982412275866300145928571624589607148633775610672363708276798036)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4544827032277589766526799535185174288558210559631988420394302778107750357902638505962045987175866174576996750349231
                                                 :Y 9628840143936539819000513496911693095220865392488587207442869557012792456016423120206583326358704288348204720876450
                                                 :Z 3526177637386752461406744632549675570792228435825862522822472014600709543359283037407789510597717690085904389072914)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8776531205145937314885428414133550303315933596158599308592498629320191485014289577766364020005405293129754662644684
                                                 :Y 6805529648661208930754825002592559029492703879724109853206571978149898991938275279944117074791523234822132429666486
                                                 :Z 9128753414188844030021722749919250319760610542574040005713628349160810372498239231621469718758101017500633691238585)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7778983946102789264207241408262513443337159150699921860666322906087173808206283425555650436640054264267099088043814
                                                 :Y 6696534606513390398707148402353759602147843286124482012972610838683510024112757333523332959260798970431190999250014
                                                 :Z 9516915746300645677598147323676884711015671400695913064137585535386122938997639611923478966147557605450744454355676)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1974833519862505250321416580708117830361939044086307206200469324682826193282265819736687608293813496582991871707926
                                                 :Y 8231819918947839484915451399022017385227928876447953700210901347967753006787473124696093733170651928735121283466247
                                                 :Z 6580366309641458034018354604189078977338590400582681727044117812586656202612414631823308748952181043775531574390715)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8891917118264671192215306011310012653689086546472197521054202591103757337190664237096359400112428472263023342290968
                                                 :Y 92589616091704113985657101761652268742417924990896697811670669796055677076942460300887258614151782603605186182999
                                                 :Z 410216316978154549604681791837821617970946472642081144540605689240607147022867471317967529448999802221667899285808)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 767960078739640764735764985985770795152190093770672162110844129379236027905849463533786892192757870303985778100095
                                                 :Y 148851740764390135354121877511597603359935648263860433807411360088682718704141425143793431551141806136284553697847
                                                 :Z 9025106927973966225421056675478969024245697870104251948578016130462563160155720120387245357671279901885687669284675)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6469205984269851212867015631200810554274876347173221607147436559091008842208027091845687590926704856579258790548436
                                                 :Y 6315896660516094229774156277719839585545628624696864928467934894339574935397356797445061180613102698033826321857291
                                                 :Z 2735482571865739086883718415016704855029931148741538863681178071974355187512389065937755902597186381059549849187008)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5780028701555138427871457343265769548978063839095780790443765565090692932268540082532318263709085868103112161531748
                                                 :Y 1268341881489034399218771289249010887363936365493119684810834195552363376106793474759037695391448970514787633190139
                                                 :Z 5923877406314017357970855600158795209917361389162661904272834602281337893036274025365744501816651174107497856281143)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2488246675452759989198672752096930656561912962416091564295437740784455419403345077321702956189453777425099464004137
                                                 :Y 806908291469836760062934518491505065654376401666367217990790830327047649088645280699948087308882284730891480914759
                                                 :Z 2656716828739801014616871348107927738878457465425352781474551841520700527465397893254031829214557339336917885023002)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2999298098837672200083343814551710997961589664380476788558358419457732435633729827287138028483424886708868600571694
                                                 :Y 7021118325465686917416366440939587868484157890630758773334654281150940855414076165332594398033825355668834631905985
                                                 :Z 297079272706367349857974108066297574162658945792274426254289374018449482417647403414013538571516377621030321152130)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5100145947417543564166223118035522535273327411620822479020785677368290683836174885220162748916101758992077241484910
                                                 :Y 1663683718908265922305988951325605870168606750696468031716012747106375200449862131898636954444445014066603087840689
                                                 :Z 3961421245584799829682272085060681723291960097622115729356619845956300923148493011403493300333081031996348442734292)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7895137042480062838177898970099189208514618365499379204099157760210184226776127763037464264349077931447105155236276
                                                 :Y 2175045504477328113841055868812053514528189773768280522483761757463563862286021932462358525520812773808867761336859
                                                 :Z 8014903166308345886133487617992992924194391449168510446755957319602452565389027986898859668225085164674134954135170)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 367012847280159244654452199042706809961721835347416648475998134699830702337126285743093000731764228872572348756713
                                                 :Y 5090233840836607534277300487170533440645338049255241247718316742303408812842322105594631600815255792538779022555679
                                                 :Z 5482895972795771567874372390023477677394833041857853366088175889158187331072332080571677904916629109702391141182269)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2176669665476006082895673392025878239849596184971519522039004945606905098657179701573298741403089768716001705043935
                                                 :Y 9368831416814558434100972100335883126891709411548313524118427243664651062494074741198778935013044767076970388679228
                                                 :Z 7256304694552004466125957658142257277301554598863112886583236461817076469219345566749467291705856569857535810079798)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2332005395862269802341904750699428934686740364437804928651575301751418707418733617503239851862272165554962554307174
                                                 :Y 2793217255997402626246953576054237866051126841736638444390172922912293281842258001850783170507600110531504139436454
                                                 :Z 929074829068523315432336382883058826258527794464785528869416299116216933122663813249489466046490492847480778752391)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9173762917465349910043925369803245525710191778155632209497246126492793794730267360604773377601561974969834054105937
                                                 :Y 6606457142672370187066252171352730367118803511475815031404595933975968023978671166561769896288836337886293875124145
                                                 :Z 7842551397631926282721674004076062066995328419027474358761954254320632035715762632648363184709780163805160116573436)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9719346600290611546882305436761124277067473407270407761097640634087772309486327926122905349808352599034581332319884
                                                 :Y 9761240264728701373382656137113371229438719487676476074209984599887433690958791134180648535811875492641644741635970
                                                 :Z 2955959232054962163403702207798948062915931378100982165880652546047106743136084282083639514811091060171833076113987)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2080098912966710763425246703351051716682945454290662397833562322666620886948571573670467797544531063236632942451317
                                                 :Y 1176935427941298124032599381666329759648795321554454814214717936474538596703314755083881086361945876821902238077436
                                                 :Z 1455939637882539664458588011748820786122566943471967422299987574186241013258109963160642065789564235466567934964645)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5938629932642507269551864439892676182335749291703482761341313570064616546663920583906504694409079597036801636019998
                                                 :Y 1646942624288743743623626870581740079548676385777790688992775313564212322517618079642415458187498517710849996850372
                                                 :Z 993151124289687872911276365194529995776555266766299358699038597626440191059232046866890523158001909823452689136023)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3792980169035647321861820784474635925684302397631094624086512296183416021142647607776270186218256070905239215428726
                                                 :Y 2095965596446613140241804452226623355655845162169991116252098823386823211112224659633746567991951316112320255084552
                                                 :Z 7742490672762032509308338634945257351801829720791580865674260478980562825221787506251781680340198018015211417302637)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8875100104813811211685779590637378503074835498739308950338029695055701834907812870098878161254927838967162985274995
                                                 :Y 8339519791419096595449427296919111826299298021762647947888177146828861311614760702181392433496334856650497496377490
                                                 :Z 1479180270214113996489077472958361073166325026373831563113109074462856866917078382986084219462879962529569661787098)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2886860608063928939299522118769509142360782087523297573851957455196418593504602886897464682019916353734313690072980
                                                 :Y 5273914009571318399001244835555111323369145353805573531926403956171270785847634865527903460655600984758750183876841
                                                 :Z 2814495635318715841118278417732169726334500260264151446798916131906743582670068046716119390903060969558679048018649)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1115768176206259938855851360627159353126184759309851663830663364729368935661066655294671530952741433963931825511562
                                                 :Y 4478988501325192798642138316784333487236643959613179762757822793853564413889525696756882910013571769823923855500972
                                                 :Z 8461664472973972133316656320793140826002580630469759874985986943526603862132171711938151771059516565685090563291813)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7725410184924339493404476347364827390012505099543342712335545919517533140944143105598344505763410775994776501565193
                                                 :Y 4444184172226968077794191972297823145551633395857127118443386905604217771179518887962512802369838709779180390585174
                                                 :Z 4467595436666370865376320276104762433769497443196286713697496288376415801727789541880627846182354640228067961250431)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4795198328777452889886534394476634354561311485807003040808824035238972899831192229015185061566481736825865670767043
                                                 :Y 9551617311347865791333892273210447765301428390254747092392470229823930700036996037766426771039473587027279520989533
                                                 :Z 2677629915708037608901070141716829292897867350740629482740577271029039588057716701933117747394915999127217498489971)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 511412186922683603966450122752419128011188103412754316111929712952758529836838697133441806548095453600826121421139
                                                 :Y 7595604453547512778511798993811969432115710623132533256291742852490807609958082810947499304131236759608233222450222
                                                 :Z 2518793678386667362679642286120524209475363932298031425269086107967926203293582549534594903324364218860533754191427)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6646860379135353154802215479884702121124450691307935195010900676020914187304977120248104919435746370006588630446087
                                                 :Y 1793348994491134795860012945325450222521944271447662945369073718553049077471938687006953615107906800899188215634917
                                                 :Z 378006467342571399075056082241897075071165854655781525722485197857469565400400308017145531947660646632198998277246)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3560448586463037943895433239138669537474355039844399998109475321207951594912282035611837296454512294863021087622623
                                                 :Y 3004229562679778778084666922455620799775971859664748179636149247138762191479655531864596854389811900303807388311718
                                                 :Z 3049033297370426836669522808641714479939542133309512675163651891329592172458686891777318531301894029640444340269526)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4560198325410196627888383406845327208366258811668514464434697321015227236049895302754955381858135523321941595127413
                                                 :Y 5521605683535234346804646407240264734628767993705005222842012230578885614020705312662374493777660869475827555619
                                                 :Z 3548282820331238569438834731297808489826925759317150339039988491760933365405550697716917545718869531073852657745993)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6763720959661244798025342916504072175973039102013383818929829448571559636124977437234256352348360767137677850590036
                                                 :Y 7789253812309803598623585993143021531150777607515157982597139523195369143864341998555426700647873298143597722013104
                                                 :Z 6377283994076386428876573188501213506431590404861510222122506904840109798443112971899560184348565225098354718514545)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 4662387310989834278415078379724316614553086009350862092378905234334483878321893188018040868062618064820490734845824
                                                 :Y 9178332603603546845649776578017322244898626873235347360046984026013189990091202835951622012849479918559305549698915
                                                 :Z 675095974778342853945744109370969348790149457713591287861795470121756316266672805524638241440959058430098015639218)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8082740779078843747329546784244851237337060553052436733611666688610332806012721233817826755714411619544880612987321
                                                 :Y 1368065256537094051506237706527209333391618148270476581812838517831878316863047652493887557078943074013544585437382
                                                 :Z 2503840362367767000976782716933449153281832535130789460994613518570008529086903183619394843295735125922176467451326)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9713710674983004967334853056178501524701054170914085996690814588750845811133407158570664033653400297965789008906565
                                                 :Y 9295075917229129849342289778594959300528840892223322854820476950318778935338594213878101329454097544708486700447703
                                                 :Z 3014888043386884280554542158347217552695026616279454800643653405740632513245506775805381095595123512636587060771140)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9109908132199534276003271223588644311511116877997675545235300591441817673224152181423925437035150824335365914170552
                                                 :Y 6742606305050571404350302484918632739938029861162319155344889964631592385235962816661223266996502687523491370978573
                                                 :Z 8737354248551812349766547827422218748303272507564409671549362923477098135285312517100301562653629106738552166254428)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9328345074116262977249139490334255370463582256909567228939716167640101677935258398954425189812984613953995704458840
                                                 :Y 7241433028150930882088240969202088085984867731864057884388508788774603749098607434112297502088957336031372002585836
                                                 :Z 947579760741723984521515604380215508920413621630523655366029769562012911332094157827346452592840891466339423180739)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3282237045429832432370808233901542824763051170719430217511771293035187419784642126959460661939198264726213978331437
                                                 :Y 3956806870375887887106140253576349050948008063291175896368039577419315564442581060738838244903694745559784592779593
                                                 :Z 2219760212137897638910703410157525243777858206724592869321536582266853160060638935896117965984915835548292114330480)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7929441927613216709666771874900685451901030499736197471217849412817414190888866882653382645057703607443730741235737
                                                 :Y 5421405769187828311150267731403441497993093435698299616896692942677569590501536309396448928318651578238207986084006
                                                 :Z 5653021418302912303568247285971287520064050458129201864522025791057368112518298063955589880954187512417723372840546)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 1971897916032410232601904364632182530255681121910610731941401107890356064621274589710675792789321627001943518009014
                                                 :Y 2494331042178910629262247959422449474698860924229667832134222908384052976697666781144772661272112241650952567201637
                                                 :Z 9304806147767961416336027757611038388646037151452779636254058402305106814093267387133473428560023236862323982932018)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7571180845507755415733369732770754093234511050610838500271391749776943465978215647104777464809849821971487710124495
                                                 :Y 8547760105855992719645026990619966110069722987724307258294044758592695227933281073118613285564920061101427744895406
                                                 :Z 4251647639142663174760407152382322005397794238560670683526786469125410446238831721539160659420798881071716940241020)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5158589672634241214825794975589579075556241515834835714382020491370595764472179983088052513381184484051956021233437
                                                 :Y 7062705077775055082350203630976804304930600484560990454341637025414110731902098500125657688926273874817687911329935
                                                 :Z 6635792007432989288714310950753435848205641203002885566579277727501958153421957740458319536659446761005860773360877)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3179632574453563143184908077614416030803304247712918887262846639491055922460115486314191020346261432108305753634370
                                                 :Y 7313414178667710177076394911423061366851173832523204351141650659993706133945946995744352393208889641362578100092272
                                                 :Z 6012976258235848343281717799021561975911355585420251838331577535762909997360918671431894065266670496863939818011371)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3554500847925715099074591199936668838851225903264767491332422438068898424786388817284779677700484157032330249360912
                                                 :Y 5156901330659022330859981172280380686334327782643350136249321987637627408265436499593049451334853195790729238595001
                                                 :Z 2679873340680172909679253861265264055604369157442061619821188363266271286828251248202387500258932341548849391528955)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6119558200481558281407051607999684740742666131399686683088308758924082608813765183099973492984379334380819575133083
                                                 :Y 1887733102234718222361578773485810728085856766859952676269171236102855520315304746620979566892180406071609020501780
                                                 :Z 9204392109500680123135451769337211485215983966398942862908296372807162495362461837959919135433212867079300976424294)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 2018606513398851015840698594668903239463785714379970507068152560994245347157689981412044489766767608650192168041542
                                                 :Y 2634338106864186178454620597691529197333979157894919031198204727761572036256884744950238954056490828070508019679221
                                                 :Z 5679307784452010956613724070709663763632934917101983034402165479569191009179191740969858888912656010402497324113012)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 59780417881124449252452063618579350572685056506248198424068085698228120790895412757350650308650344293217144027856
                                                 :Y 5829227440924110924337515546466169147622565878994593123425983049477047563225471451170355930115556529649392256375263
                                                 :Z 9130692714691773619026040920461799887580711296965266215599554590420371159368388897520159778661754307694241168227233)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6241742503750656950003644050284612628027378987285236722199843056400382036622494033687087787103923024249710798466568
                                                 :Y 4318509635700503903031420454497017801072564228923780571184548284933018916628061342431210082906429192258948783196
                                                 :Z 8732452439177185310057480529742063779816095949516910238225648196956779609350779645766523194485685686907463663636230)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9482403751034476862896943519800817915167114241503715571085045546473063698203728867170088037140488202622337705627231
                                                 :Y 2640290059652605549024914923620151023017295617322740353062055569045573612597845897446989237873089247614760574315377
                                                 :Z 3003863300573842565303080805794879295938034738196608053078949632682170701167240514765198624524179230387802360304498)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 8269735115868727780637703850918165258008123697560963810849511059683672291292433269189075885270672609147852411876983
                                                 :Y 4961468946011372073724658218401319132530075290106981002994774623838300428267093532324421407366844939351067689926685
                                                 :Z 8454614062556805683983092524623902295411689484455757771836065401912509794609258092922685677907414297304981052408931)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 9699303558649484942081088755728085170032842734543758090702957158924499374003868084825887597894979774885650430951730
                                                 :Y 2527088349474995268641392060184250690011783103415677250532294783667097704517085286331836414648865816302988653820871
                                                 :Z 7074489490955451845447452267805152231058250915295594333694413820823531894619231769731634970130071462292419045327856)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3005967263631666067058261261693746538644857554991793071063050672195078242770034176019935089786004745558254462420773
                                                 :Y 1284355883776171291621907938086455048408693772253197187012325763579461098923045397167165959313567523432662605931062
                                                 :Z 9511315875700852741125546267895029025077851658146944483168078429587869935739094667404402038169561652938042093704953)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 5460979305171716974682737660614895878013871510299741740492718382512208646033914945297293107319727570220453687218545
                                                 :Y 5499420291966368918918393966125952953413591224472674350193480806473066329022131805096423327075486155013691799164917
                                                 :Z 2930591655651124292806889967061736025800359510850150698229490555043485950566816842416273635937590981933692439968719)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 3413518232510097916177770958705034733662873026736759809526673870344522713054786612159896854559366441697561386466015
                                                 :Y 7517569286452421276158793383153312577570539246200938859856439008398542941394732195074701359919459806030155756147337
                                                 :Z 5198775439618072362189798239619088739739768065359817927899599994872843107774251347532437287225020742166691108412632)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 7577702058985656937668675852346796355909074964983279349769067481277738293326083425942496505084724477013382244315835
                                                 :Y 6412079947975832834419609585180641751247630911687428439159969312001829477715907362627905839242814149718570226318654
                                                 :Z 8514845538248260583393209128581878015428757950621925320820569670350319450756878735781072981041720989725729793759169)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 6125229836271760279489124989866994093325163711901499108788521774008549816364126638694817529887657126911267540746674
                                                 :Y 4700693857406479934713986988699389145809802846962128390682204286227532848185342490147920202735716324711094544530236
                                                 :Z 8274089360318235469554036593705235866729429163133810925887367798843331160792330603983998907018277381684199497654544)
                       #S(EDWARDS-ECC:ED-PROJ-PT :X 889062972743768041546804727273658888676002956858668009233577071398646692510795350153124591801493350447732141784867
                                                 :Y 4526810534902653829814309264827436258898189794155722526799642945681683155117297138087736781274369683036122465401820
                                                 :Z 9507787602201723372052147491550764275248437713628282754480216598228666537920807278018546459799443464094514589685112))))

(defvar *chk-bp-basis*
  ;; = (hex-str (HASH/256 *bp-basis*))
  "f517bb89109c3b7470a97f0c4b6fc1647e515f9426fbb5aa6f0786065e29c99d")
|#

;; ---------------------------------------------------------------------------
;; Another for 192-bit security - Ed3363
#||#
#|
;; Constants obtained from:

(with-ed-curve :curve-Ed3363
  (setf *bp-basis* nil)
  (make-range-proof 15)
  (with-standard-io-syntax
    (pprint *bp-basis*)))

;; then copy and paste into here...
|#

(defvar *bp-basis*
  ;; NOTE: For Ed3363 there is a >20% speedup by starting out with Affine coordinates
  (make-bp-basis :CURVE :CURVE-ED3363
                 :NBITS 64
                 :GPT #S(EDWARDS-ECC:ECC-PT :X 138988105871668483932452846852599112720251221771110488401296382851734628607529668409375077594089886683
                                            :Y 104694584653102240817912530416127248900184091719266081049029515505661781251886810525092002905513017676)
                 :HPT #S(EDWARDS-ECC:ECC-PT :X 40147176480380403469749463131679969588268041653010704540951800457675509941021029564497155493655305159
                                            :Y 63108039373371635258225467801023954269762128116870180876960630631416922867128364778156810663876045829)
                 :GS #(#S(EDWARDS-ECC:ECC-PT :X 88469817668253864765426944015862337751976459373440573505688483506713122324519791399722268585661088914
                                             :Y 47157274566848713621793715612370177018556640643725111202866296822706330892566900847539032912458962347)
                       #S(EDWARDS-ECC:ECC-PT :X 102936589783347045838976635469099892807211865312812251404810356115349404950659087843010642625646935595
                                             :Y 10538494584998968801398068602467774460247081304537919935531257258011326426830393537055282350346680135)
                       #S(EDWARDS-ECC:ECC-PT :X 48163398474913675847175594377289871954062054116458461968820466077676423550478003774255974803766343725
                                             :Y 6608819833074102208446879606269102467843193318919128520387529591751115158397609653279198395404895900)
                       #S(EDWARDS-ECC:ECC-PT :X 36693739746086811154978518095379973257952953324461626016494629592697051795264668162841703652483123241
                                             :Y 108210049395320835735096248425660411339180610915684413185455991442091479605870325502438658191698031562)
                       #S(EDWARDS-ECC:ECC-PT :X 44859549063378476247159707454465260861290971697650142669903843077611133629277801760360239268362405027
                                             :Y 40903949574479174619133897291996511414311912317376280586219476791764555357824949209300566824014993976)
                       #S(EDWARDS-ECC:ECC-PT :X 111529969373152108647774170441223883195011021566438179105837738964237841036752555191954786781780912406
                                             :Y 129599862419787173105762831743394170825366493391560729995806927324990581321917141744834377358847659533)
                       #S(EDWARDS-ECC:ECC-PT :X 9910678126533339386526485753236099734822862469391309719661478031561177553224274779147124693698642263
                                             :Y 105519725782449441941740305777226022153125836004773569294719562019160104760305502326123590547423769581)
                       #S(EDWARDS-ECC:ECC-PT :X 79989597146153704387155060219236859702165622238430191978386971379283422688466111177934131969997923904
                                             :Y 87885065472916356379820125267830551633436980095837260343740540490995255320308447195405984704822951722)
                       #S(EDWARDS-ECC:ECC-PT :X 55838333517543538816740524182226448913473394415582411661771423895287635948078646329148499415970554303
                                             :Y 2977375716615158008348258622582683376785108033917543016274123171521961321950595352391928404447475643)
                       #S(EDWARDS-ECC:ECC-PT :X 52529730855704757921782000633178265920462202326188586234256153787069668747849831026747145319090836810
                                             :Y 29389561929169484519703143241823056682442472720149711688619904436370640332901255272880722674996865581)
                       #S(EDWARDS-ECC:ECC-PT :X 34563215367124209421101036829179375098240126721330174566729274412560236522155950724210906273587216234
                                             :Y 36344974237171271203114370857892868658206504207334256502393147443275914943798368812808094601007071193)
                       #S(EDWARDS-ECC:ECC-PT :X 19532431137934928968909309627847152105361765112535916385585065910110599119978776001341468613183701915
                                             :Y 122324197229046831197391399779079184510205282898148560708668518783977578389617843162432055674250806483)
                       #S(EDWARDS-ECC:ECC-PT :X 15190133381665015023279519152753579744640225305616855202523368945583638271178940658313144684801800349
                                             :Y 88039881190832040447137524596430952822065082337398651340055126829901144231336417801087234225519437414)
                       #S(EDWARDS-ECC:ECC-PT :X 6533353751934277763572210556071659695689730452127961880114270229169605727040045316985503317868635158
                                             :Y 3661416757598535180761209672546437626912062893787814460021475995111186072715416414913096362289957284)
                       #S(EDWARDS-ECC:ECC-PT :X 132584754093160690528714765837242923353573802832726394744829120834838536712477439245347106677204932096
                                             :Y 97402716977310356710105704962718821127491704591931356606064239922923546881198990898983183690137354920)
                       #S(EDWARDS-ECC:ECC-PT :X 127398073515006273490195176940203372037462834469150793109000749594410961248271396555175402652349137752
                                             :Y 29978996601666747897727877191302635398933048655025787182565843785034863795773931903720024669935773554)
                       #S(EDWARDS-ECC:ECC-PT :X 21448309443957233290156322471445285599304571134742784391843897424227250915892340251106046247306444144
                                             :Y 28459963684061663045778665306936475818868747091267406440015273168958219962884356997555440366616396881)
                       #S(EDWARDS-ECC:ECC-PT :X 44161147393498186173059136694986368626751466539418225155124453421790056107814037383158373032988637116
                                             :Y 34065096679048880222671364923151270227039752153489673598442361940358658327144118955343592563747969244)
                       #S(EDWARDS-ECC:ECC-PT :X 57022030357853156704402615488658150172854265774295743770229323554863704168351682294623386323054710728
                                             :Y 43159960373551265968905409329041164474712854155173072131421626737573779780389500019993172266351250063)
                       #S(EDWARDS-ECC:ECC-PT :X 30374455916284458177239207724524560674968340858564403470529498590672425013702404932933278145821506230
                                             :Y 31097565992332431330261273913496039278004353315918856292336268230715311788471081246269009792347760166)
                       #S(EDWARDS-ECC:ECC-PT :X 55318157507075030692247596625768365115164947196162599738652236264202635762639309788703327677854961165
                                             :Y 128411425831858657573458014895050389193199681857145350802996615618610279585471586854775168129648561737)
                       #S(EDWARDS-ECC:ECC-PT :X 126020590335906695112141825401233171658865826060024633271625163952735432967681930145571806739372551109
                                             :Y 16348353943700838828997591836267869064989587586474981747851058105164452439355528714173602880539632959)
                       #S(EDWARDS-ECC:ECC-PT :X 116083134667555123685280667775910482974345050287020773341649451985409890212044533456005515123479446976
                                             :Y 121808805854696293846963747953997565192255613389825933658037812767633857591951901313086313454269177808)
                       #S(EDWARDS-ECC:ECC-PT :X 95910263797913370693589669151682953011332759703828018221277292378402624080398310412040051717458218440
                                             :Y 65678924253479727672360054319393596428512895997922128333238819436010799534288721537600555947247133924)
                       #S(EDWARDS-ECC:ECC-PT :X 137765976599977879434279624359545765791667361343800328746557236200618678514519224280410475558517263954
                                             :Y 88333754339112951726260657251899874953479635163189698762334551092071436240778741182531773671573157926)
                       #S(EDWARDS-ECC:ECC-PT :X 94983841686013849375788718120607256996911854339465437016524594948425818869649199205280814515635442312
                                             :Y 104458737350432632916798796154579660073483321069487867844325886485577112225815578920773989621929967846)
                       #S(EDWARDS-ECC:ECC-PT :X 32104318551023383887902747838444360500743105781144828966807649122497458840672163710416783565634998117
                                             :Y 31977184811529154272102116003804490639665383169835035402114336493439385206034661828281313799452693306)
                       #S(EDWARDS-ECC:ECC-PT :X 110737201698827167420759162691472243707242398789798273938136134807786838199828145309751636180769157273
                                             :Y 76038869443354267582488869624163267522622083638610099561291535613508054985705735169687562582497153808)
                       #S(EDWARDS-ECC:ECC-PT :X 83289750009411211954433004257451570455355420101326143485273552134363758914803297118393649134828554294
                                             :Y 59292341052767995653472723535279665890546461752823125568062325132740668249364120650003372291146326757)
                       #S(EDWARDS-ECC:ECC-PT :X 104279961468166596787353324914580198966256214913482944225157511075040817484598931457081402234409135366
                                             :Y 76921246343619038346783663997334211003386765619685380357346254378745774537174242268647399495669616094)
                       #S(EDWARDS-ECC:ECC-PT :X 105311004394487201584845014042138122476565903876234385568672331171102691548202828813145476943597955414
                                             :Y 82960905780768476867723193176231582682646498676883345628719445106232526198924185228988004524511005443)
                       #S(EDWARDS-ECC:ECC-PT :X 102675099366566643620874313659777381901423702710395139784172834094113299804580969683465826028427961817
                                             :Y 110025397632310762593830407344799241979520816780601076720841726110513457253762801770346064289287097661)
                       #S(EDWARDS-ECC:ECC-PT :X 81545027444763849534254379100202876147578024876233785189469182104280488327685794719428025526808610118
                                             :Y 92885450229824966658340979561937289847780397925153782880929033964411946498778461121001490591188367204)
                       #S(EDWARDS-ECC:ECC-PT :X 123330209458050035860861250561809128238312442581797798071463946135769147947834457370899835044999600372
                                             :Y 117281138076298074392160705798847167651613692573956971435264482847659734320886597848846255228365834173)
                       #S(EDWARDS-ECC:ECC-PT :X 128636574313604657867778009515776151573898433621120223310740055652825205360036836759408745339162947969
                                             :Y 22284351852461629386668172124476841023955599097826796519880759356110687551137100734694514414935703481)
                       #S(EDWARDS-ECC:ECC-PT :X 19928657639230078483062965543783087081329587211305390860546653667595341377378916361463282912785806677
                                             :Y 51666498786895026803475584324147777661417541093622057364859134635407832712751873453955107852293932867)
                       #S(EDWARDS-ECC:ECC-PT :X 7640174509639147309749969610573516519475266730429124906762605218516341070613993320406124893305229676
                                             :Y 92867255224287790785031775608609605064869132600314649747106006104406137948162776204082242144295913300)
                       #S(EDWARDS-ECC:ECC-PT :X 70834337479891617099419237373062653800395802613829282250556240661954308359231232615986509419626132285
                                             :Y 59400352097957477004406223474536705170440737769966185869302762118840525425018763734166019548761396499)
                       #S(EDWARDS-ECC:ECC-PT :X 69771593502866273777657480958494425681622568015673822340695249822547654449649788169769803446917835198
                                             :Y 45046014689787417394271151593266056004961247816493315587362314591792895898979626738092629095922592226)
                       #S(EDWARDS-ECC:ECC-PT :X 4724988829540010207755254479501505467834341525001634466845606244658338962273028906174436856356976841
                                             :Y 135332941630469670481457582616083957284071647460401053498157566729288526916588839112120252453886211951)
                       #S(EDWARDS-ECC:ECC-PT :X 102587735188110828920928824886320608140305700353538036601322545976551963012951018210481068605145821782
                                             :Y 118842815476067157623380620417729135969765543400130184328775912678064918262477875166311365055600841402)
                       #S(EDWARDS-ECC:ECC-PT :X 13847736069204744410329322469713775644406786954251645280972812342984976677720722321333420059522061982
                                             :Y 17635938314999033637707000140103307860367838342361478631321454414266219429965128096696789430969191382)
                       #S(EDWARDS-ECC:ECC-PT :X 19783146129730484027407261062327643154302175973569089908738011479546761159548618990884051963987994424
                                             :Y 17104156753129605216452816242423848214434574580675597836399219481770879751506409197642918136624050720)
                       #S(EDWARDS-ECC:ECC-PT :X 138133669315869797449451517056118306659484995267610868140056721411335752181903184617191588707283257985
                                             :Y 108942261857617309951137103213721909595136280151127890855387592959035500518941347256433473439542562065)
                       #S(EDWARDS-ECC:ECC-PT :X 7062747824959990496173156142253414069566806976975885892115728922296576462699766441003220821868032257
                                             :Y 114715810522723683603087878660341417490360523489155653472918157452968913446860603330630699399722297597)
                       #S(EDWARDS-ECC:ECC-PT :X 18234617124063132153958758689579956764745759440878850186540738431844705083682995724352649575777960011
                                             :Y 25905475555858406509942166370669747239617430809104720298390501875080015278331397719824435358519044092)
                       #S(EDWARDS-ECC:ECC-PT :X 13817157510087153007264734847032937578692250198172847056230858133807626767717856245374339519212482708
                                             :Y 62664253806511867683031055544173744840274444511806264844243962708231402158194208358097758393660023708)
                       #S(EDWARDS-ECC:ECC-PT :X 135713723890068934929200912013074103311021053587184095900883642644078391351826564475592680675447698023
                                             :Y 41564896104834869561572920322364247982635801285737306215093071034302721546921437702204177123586444460)
                       #S(EDWARDS-ECC:ECC-PT :X 28537580138489098355840499079486740869921883458183350017567918959337982397448001396502040088739862445
                                             :Y 47298046962046396249157878437812482974423993541824689658332713048613474763845094806781745742989032770)
                       #S(EDWARDS-ECC:ECC-PT :X 14144255238135923146042024007669313993415987961407918251976781424504792936473855305744231009486218873
                                             :Y 22913215168088513794990256171744709970284729809965007992248611913570245278950752928875391891209475618)
                       #S(EDWARDS-ECC:ECC-PT :X 110344979290642141007003093848379020177651000427767945336388198149191632594863137013999489149809317691
                                             :Y 47855531115310487323141936096632813686982213302830318861037158232916078475468961945671271177968520820)
                       #S(EDWARDS-ECC:ECC-PT :X 60502976441277322046506393108493896873353522145709056938166829187052025178653254788102528716883385659
                                             :Y 132488689596589221799659692307262290239322961519101866269707188773945501237937211710738115955485017199)
                       #S(EDWARDS-ECC:ECC-PT :X 39409253865588946343964160386073048525089549831763994271588579158694692701871303789178819408415031051
                                             :Y 98710967235655632373888903012455461446193086689469722233209671896834397675071134678475870826696545239)
                       #S(EDWARDS-ECC:ECC-PT :X 93521857695991920469150680306223532383007839937539124606396616714553536106357898835952373278124270790
                                             :Y 119826895658270580366203157262083997979087683449835866559732652571567940695528265887655310378184029445)
                       #S(EDWARDS-ECC:ECC-PT :X 32837768618004130072440571892832593529883873027940234759647727536104963720183044775610773605598107605
                                             :Y 47185876818922221704008945662972720645775545462168709974284484209756715335548460291252854913389378914)
                       #S(EDWARDS-ECC:ECC-PT :X 47338261463167293236202883315037372527079692610701077769955924237387539229929604373082907112840991634
                                             :Y 8418783542539963087643298450927280166894567361610069218810249312934399805600162867317620658235730843)
                       #S(EDWARDS-ECC:ECC-PT :X 12375434680602179627710605474771741993381772761805341391002379941882405235853315525056800255280376535
                                             :Y 32606010453869174439329232089690252069634784025530994410208127858224796660880180133334804815347875570)
                       #S(EDWARDS-ECC:ECC-PT :X 33723316265855272713358083602708870395323286950588450999570988142597696554531601582080760440308620149
                                             :Y 21511206959920287565437914043926607186885890956457635413091882537855007350523306821400280914543917141)
                       #S(EDWARDS-ECC:ECC-PT :X 101373898388318791701944300003125014524654891898674197928270461616783204113159966637244421511166218533
                                             :Y 16477623867494275363450803992721755070958955933296706114494252971841222831413922528142008378902458951)
                       #S(EDWARDS-ECC:ECC-PT :X 95862663672313305721295168251037020602521073126050242950951626180175135383958884074044194520090497204
                                             :Y 39423279602388332758312959730343863639659605664951726309483049771474664017478965656661778130705099628)
                       #S(EDWARDS-ECC:ECC-PT :X 7639987260184150846042311556293155010904735527329790076924966059104302221375507667294980440806536073
                                             :Y 14703858703972029055090445469660088946872776108280423763757852935755603405580487600887818021556902227)
                       #S(EDWARDS-ECC:ECC-PT :X 38826361077887817217129603469774684116325164250966120823797787113651011984224600887974520852675646848
                                             :Y 26548584999586565094397929280703614751834314685955478951419647494414504822968038216375831037053456006)
                       #S(EDWARDS-ECC:ECC-PT :X 44012305798646928449892801040007494902930572558626443079425896951179790371601928981709031307539083783
                                             :Y 67159863007811556351664207201634436589692517712097816359598050465788515845260772608207989723948896234)
                       #S(EDWARDS-ECC:ECC-PT :X 131360374243457503315019886383257651085623877135483848708060291592974453831817814198567629939907163933
                                             :Y 59730766231603503760402644344048885277903549389339540040373696560717534042567714665589923009767421813))
                 :HS #(#S(EDWARDS-ECC:ECC-PT :X 67612539521008026691196400436737254423385513605390971662082576352492543671552538581018184004639901342
                                             :Y 75151499856479428441384190248301332774251456080082015547303963397511812274472528735149833013707928700)
                       #S(EDWARDS-ECC:ECC-PT :X 67645474764980586857199553420236582906078966091675872743797804457197946096457175645560521306690868952
                                             :Y 22823737899952648991970455598873898853182909572460404737857934698791181230710113772948022652506122749)
                       #S(EDWARDS-ECC:ECC-PT :X 30888649387295355434262666777055492955126390450870726672483214011268001809900920935545059833173185057
                                             :Y 81562107425792948660491643053798871605967070487743307491607983862062927614557798550119084053846193878)
                       #S(EDWARDS-ECC:ECC-PT :X 129608604815119674025107244507156375273139655412758339545804578408603427755466951527289665342737336392
                                             :Y 93683518551388524965646125961256130815914861571336795209505826356479116084232539665477106860004031868)
                       #S(EDWARDS-ECC:ECC-PT :X 108253531908153725774115157062254454550506021945406922240698149057622735115751001187293226028867835327
                                             :Y 27980427044749756302983036943763185891073350798431494606204092327345198574342860938525172065592419576)
                       #S(EDWARDS-ECC:ECC-PT :X 36384536181567763985473686862997983595488164745465224031141339142618906801771546551179768123562220951
                                             :Y 38917171693483016412986902636956574241547285082196171219459029716563546277138413400753041650615970119)
                       #S(EDWARDS-ECC:ECC-PT :X 99377799199029680792762874872303438968344184091812507955363803282428058451594296792048024072766018139
                                             :Y 77606968688643441116676372508937206581838457130045144745885920297422587074354483215448101369572374097)
                       #S(EDWARDS-ECC:ECC-PT :X 62103700237787955497409997551193414266599244375441983162870159702149366799513499648315074535087442590
                                             :Y 64183113955026529143284812551512375900451812265374924136646343769558424977212530742480222738027623026)
                       #S(EDWARDS-ECC:ECC-PT :X 120546889554141763691559804312451158144121317951163075270023623767433938234935405061383945714259452493
                                             :Y 84508633234020430246036619411258112190906046961562589088902728960872961853551721017945119314784256720)
                       #S(EDWARDS-ECC:ECC-PT :X 920991138598820433803475627634002240723136476086973372157813110297741189811241842851698064600765028
                                             :Y 55777762045126610060460538786883864891193235689240374282087724560600574513214080857633138466988742960)
                       #S(EDWARDS-ECC:ECC-PT :X 2111763131531686986536851699058941001988703036751529451864337353513405314675055725205026855981264828
                                             :Y 115935081155053901671315167121322106340668423649916931231249309096844019797163964443944223805203481636)
                       #S(EDWARDS-ECC:ECC-PT :X 121370955270180561631826206348514653623227489242472427215200524884254646281960510159676662870782615547
                                             :Y 109813223144779486295356513774945109367193188652381917382072553875389324229675657332042987467156654019)
                       #S(EDWARDS-ECC:ECC-PT :X 101553474742797962506088780748572236234199264423890632581656546575159581049688995414709514909624945931
                                             :Y 118816969044535832604768262879134895699644423411109889348473839285357461045649196534202170775768297940)
                       #S(EDWARDS-ECC:ECC-PT :X 99662269850273701964821029088858825866024104479630464693420672304254664345425640347627318542413696101
                                             :Y 1858470102638038714601329413768368777073385937029467263537596595914790513436320104211553228285008049)
                       #S(EDWARDS-ECC:ECC-PT :X 104661042062477967558638230333088648655490202200317877399251296178658529820879565606400939085825233379
                                             :Y 13923889202436888794727803172674737966016910929919419193626558675886967443962966620612739105765991838)
                       #S(EDWARDS-ECC:ECC-PT :X 130777849012119361768412787910768171792089424855640590354545437735949917051928451851222481984734497458
                                             :Y 35379068077442347405843412953189366927847882355850710746144860215805338912266010572594338856971318798)
                       #S(EDWARDS-ECC:ECC-PT :X 83780084145438164105848552264702351171683046339641467582824430463580046072214056020624019917775681572
                                             :Y 2791776249258154000636710615999646202266866678440872284038512757678881225137277435155599101180010987)
                       #S(EDWARDS-ECC:ECC-PT :X 131986833471993447165726306925394630267471512796796985487300516207350489691753953478140273369238938454
                                             :Y 65906037491996116448285512396028807014719998032768319779218047377001950447196436281599299845154004548)
                       #S(EDWARDS-ECC:ECC-PT :X 121312475336390913985214291942541953889493965277754350771980292372137918147579731868134418649960896473
                                             :Y 89990782460317700004145872073768804793159922139998098715359307014096400816626060221809280753867478122)
                       #S(EDWARDS-ECC:ECC-PT :X 77356396092334711289351002649989242805055717793801776294018224538954644687730496451614255264169431924
                                             :Y 113848810393345834967123692120089580245935818922365363176922178954493282463018208204264152429889804843)
                       #S(EDWARDS-ECC:ECC-PT :X 134975344641459005249006529500024973708815148126934075293236639473818273417107890924514979630962557213
                                             :Y 46729500541392797067551985191893542747237068480970280154935131475002807783381433119024087503041511874)
                       #S(EDWARDS-ECC:ECC-PT :X 51752550660410928157202781386960157872139528392923668998952421544052016238781992921694782267382036408
                                             :Y 1946829727563488229772340226993537619189016884703363645339403677224929868310244337280164232216366255)
                       #S(EDWARDS-ECC:ECC-PT :X 135265239424769190781344281663820523383768726781783940986939074792408630433081353236566186445308434192
                                             :Y 111719197795628321712500303183368345392915373617444867669218432455163465940772399796417642992140585982)
                       #S(EDWARDS-ECC:ECC-PT :X 13015625620344340227856917862421471790597495630486629618003537511073724939556555303186506046266597618
                                             :Y 127403015280198378228204823592415772398168251721381609311985962360167038082175494524219572336988972323)
                       #S(EDWARDS-ECC:ECC-PT :X 97677255764817894620703733476330133946250937209965266916615915880904547654424638351532811178067679198
                                             :Y 108894093697592017397605288908761581132484320234868684567058063839769327674497211103876898164762014060)
                       #S(EDWARDS-ECC:ECC-PT :X 29468944898245567136719512852644689642279816466415192585641530726930758662960847126549229107543473467
                                             :Y 31306146782247001544398485358411861085390896634883361506299572024313402249393347138970768164688493325)
                       #S(EDWARDS-ECC:ECC-PT :X 67497355237278913668698740474367767881340854009114515688582809741195637437543446257859385162348164005
                                             :Y 48385877336555936818793084896592123614738389761744633476251469041991984666256808488014066740943166772)
                       #S(EDWARDS-ECC:ECC-PT :X 55883262241787946764393709068945139156337766612401662779673488566306859735615727701825443504321784170
                                             :Y 31966368166335452504914354647765916999499492448573830811075656748788667723429204813817439701979560852)
                       #S(EDWARDS-ECC:ECC-PT :X 6281091696548710446250967185156199193709963090521733339705747032785739675870445604659143743028112118
                                             :Y 29847998968927155000475324266643592725203033251788466843192330997983305103663781026718467855342323994)
                       #S(EDWARDS-ECC:ECC-PT :X 9310025758173873292727282256699005846164154517535972615694295732529321424041511003827636270512073701
                                             :Y 51960947445009076215507282749393375888662677846556237510774224323157251649172738066276874176085167900)
                       #S(EDWARDS-ECC:ECC-PT :X 82715882271501123851068344788612729462186296277427753623307685890573428721756458182778266364087776017
                                             :Y 119131791023012965755063924600172923793370843126553689388252069799664375283314243592914897556995660065)
                       #S(EDWARDS-ECC:ECC-PT :X 14992971806787957695760846203605940914061577345662042876212143049691169359042852023524565596387583758
                                             :Y 108416374017899950746415283488353997392880623170311546371424520811126361841141943188327309961046898540)
                       #S(EDWARDS-ECC:ECC-PT :X 41662363947969475406649739359477256069156170532974835218632039577774798423259203745324469710855695387
                                             :Y 1139365692947794582194748138348686317645726984489440389148343283805948653309022338341728454617530978)
                       #S(EDWARDS-ECC:ECC-PT :X 71891659595433747654955951426324571543610737813971692466417368368320796282243767310092459480637400594
                                             :Y 100994065106163364689378400568698822106838756014881192553921842553324136119978919518024776708777237729)
                       #S(EDWARDS-ECC:ECC-PT :X 107504549015848489564004516640858080185091340050136803920477193280634773960152743278365982473923821163
                                             :Y 30273384666300359429298151301665813977086074127857066106592244641157139037717003178262680920871352819)
                       #S(EDWARDS-ECC:ECC-PT :X 56577534410263441572318389942904981948161637105873734140613040681570796122620000647625400952341580395
                                             :Y 132507310564171110659930650841202564160294841199884734140329173443880819588935570378914535055172956051)
                       #S(EDWARDS-ECC:ECC-PT :X 70109457178389272402597865776081778851814959400553824847827549415999849451423654426053732365910611538
                                             :Y 101666985044721891920935729623393397391307262021900093063712185863059349452432461587984138917654999858)
                       #S(EDWARDS-ECC:ECC-PT :X 51530392407636453644814397055042818031862678452741501502821802243646650290780925041238476253383079865
                                             :Y 72175837212764794609371600953769081517398993612985337647798304185201078227707920514729815656606661441)
                       #S(EDWARDS-ECC:ECC-PT :X 13677476240864541928157594408701778269686198832935781572051887823089638239914214797033859016541545887
                                             :Y 76103085454453002246729283228730797157876226961149810037369133609232411016212113727789321025669930480)
                       #S(EDWARDS-ECC:ECC-PT :X 79102343996177005593595230816082626580519823462069140909804626495760012807335783513365672144168342396
                                             :Y 102791761115537174989822924270156285273322126385277555412167991674337214532072726199214365632936601680)
                       #S(EDWARDS-ECC:ECC-PT :X 2957210783073147300193422105413399404478070720200202912071396887480043892416864826191767335472940245
                                             :Y 108015545060679417238006602977319709317208012273191668797230577305418287750283506814593525643798299192)
                       #S(EDWARDS-ECC:ECC-PT :X 59575020885476019744503241067998605349805133321181364177977903690031128000715512797293508529224624265
                                             :Y 54193394713233957785527743102760704257518428021809756515319158158900440989989060380073296302598605509)
                       #S(EDWARDS-ECC:ECC-PT :X 108038468635175725993730801921424049757107288694046211285817833539294825433674908908724330833657522581
                                             :Y 104769470152994867511747486629733914082743150652622639379225767429409444962619726157225901720669957882)
                       #S(EDWARDS-ECC:ECC-PT :X 14659626647647508288410919034877248232606861980023451455688078212107871290845876347275203013204000329
                                             :Y 95385652480235338616521463828013222158444691147640215342686677287451652959911514112637149350845786560)
                       #S(EDWARDS-ECC:ECC-PT :X 37183503809627187709895663168289078228639303156959646779738980383818099200107389261168242673032210390
                                             :Y 45969384652419913332272696165712511377906373161016163460294617307457203634145065579680255136834334729)
                       #S(EDWARDS-ECC:ECC-PT :X 15557995989270203496106902391417137410601229857873526560888429913483033589132782217316663496771523356
                                             :Y 12011043316529893682156611679965227032222291747498270705380416411210049402155372330146750732546703957)
                       #S(EDWARDS-ECC:ECC-PT :X 1663726218964556949136232665208760565968518209944077576755167389439618172714204754329249874284120765
                                             :Y 74709087552182337088447470029869606660057341202807115008329090462332747697297162582137856975717389826)
                       #S(EDWARDS-ECC:ECC-PT :X 113692683405258608818487814917834561153236928396596609265298103791794636115820821939778389769723942908
                                             :Y 68014835552513088817027145053852315180720821004302854433841832173005887389068754687464204972568318408)
                       #S(EDWARDS-ECC:ECC-PT :X 134952175379510655480863778291700027058725503468365556613488451570553905762193467605305051197291215650
                                             :Y 135486856617902548987915526877923438280692506322231751944389737173377385968245867264642987323717538076)
                       #S(EDWARDS-ECC:ECC-PT :X 19016463306250407475338052883902870512147966858715328537920475107515206145286138448419864220966264775
                                             :Y 43977327476926568764887769580120664108540053033535719883337144706125150313106102111223248666868402052)
                       #S(EDWARDS-ECC:ECC-PT :X 106420948551691264827946152496223056115258026140870127057216355187015542425744854706958301127639581445
                                             :Y 24858163496056969423237262889991913045355976081928443226169403372294820338009861247393687697500832132)
                       #S(EDWARDS-ECC:ECC-PT :X 31786849860099490460430636351073922516587024722356350052818911076257025967269416227466654566297008268
                                             :Y 6352273031247463269158288661891609603890197435858295155972179921622441082626393459610181553149707971)
                       #S(EDWARDS-ECC:ECC-PT :X 87026469552138325619073137463881226767492690666745435610929766328738060212645173447974680673788144498
                                             :Y 138066705301850084699105636103621898095600570857357220773886842939474789248957010480458944615143275084)
                       #S(EDWARDS-ECC:ECC-PT :X 122524226107765324901699919591320036946748920563272873235766995639812982504672426741918462446135788940
                                             :Y 90063638404232201067238355375315416270123819895461824222602334509539640933538120790941072408527422181)
                       #S(EDWARDS-ECC:ECC-PT :X 100529860230283362863269253743127359836410888535308210282220389429548792808096640583026164709097518198
                                             :Y 72397957442631168704587378857137141919450438920271037986430793267724396358051175469134965173587893451)
                       #S(EDWARDS-ECC:ECC-PT :X 112284136425136016488544886683924746755137483505562412897916848476889742348523040487356764588221066749
                                             :Y 72078513108783763352610628977208112546724411941188746464434416021199666069356017217990638572189175995)
                       #S(EDWARDS-ECC:ECC-PT :X 68878829257366500657600537957317810767067938419772208308261483456198368991805610563437180150881253762
                                             :Y 84240518129441858178376516418653406809501179451493922655105715465844735826633970491935827027971908932)
                       #S(EDWARDS-ECC:ECC-PT :X 98807538428893187936275935470652835152583250833931124820154806153940169341263689682888035610132443779
                                             :Y 120858745001604708023993340274455796186014509886489170516561138228138634112912877276480568895622786514)
                       #S(EDWARDS-ECC:ECC-PT :X 127684489935459095096201234314239555781679324726733350387458471739931169448070834643076317033151186663
                                             :Y 120130730347953573919491840699516465749382375408980122451096740344380484928608159426884775371813727439)
                       #S(EDWARDS-ECC:ECC-PT :X 65122639435984598026499444245384854033551094632330233053922807180410638012740903060424353147387477293
                                             :Y 22803123397658753392702207956916501647041995484128114262506725576831949693736874957321026170126064104)
                       #S(EDWARDS-ECC:ECC-PT :X 48210453660689983599420236249884458155323178737898937908665623286135810117898317672658054434721688878
                                             :Y 3857846018960059521616150824043489679601914932598776495944310602925191660143638574328898156172897214)
                       #S(EDWARDS-ECC:ECC-PT :X 105968152960684772834228102383082157621763978818583662212602933558827562069659217627078568099438070188
                                             :Y 128382501823415793112357136167375348434491454667477837757722661790401332030810955470055559677194261363)
                       #S(EDWARDS-ECC:ECC-PT :X 62859310690692104439190754696506425170686824923334672081364245153911201754012804608321252724805993020
                                             :Y 3760421780060498487517447320615378370810044963886150660061928025278310740205627871036859005592267876)
                       #S(EDWARDS-ECC:ECC-PT :X 15568750589062821236138807691374198983959891811555119805752749545706365617418647513300302985006512476
                                             :Y 91505405360983251888250387839928569183865835366962010210822736086026219950642076015876943165831719768))))



(defvar *chk-bp-basis*
  ;; = (hex-str (HASH/256 *bp-basis*))
  "A67E8B48750559A9CFA30B27E094E98DD8BC6BA22C1606AAECD7B9EA00E9B457")

#||#
;; ---------------------------------------------------------------------------
;;
;; for 128 bit security |#
#|
;; Constants obtained from:

       (with-ed-curve :curve1174
         (setf *bp-basis* nil)
         (make-range-proof 15)
         (with-standard-io-syntax
           (pprint *bp-basis*)))

;; then copy and paste into here...
|#
#|
(defvar *bp-basis*
  ;; define fully here for default basis so we have comparable proofs
  ;; across blockchain
  (make-bp-basis :CURVE :CURVE1174
                 :NBITS 64
                 :GPT #S(EDWARDS-ECC:ECC-PT :X 3192797635315329847856797855243521929742155904688409191427671168971690114593
                                            :Y 760680895638602964808413236003639746467961596413872431344402634439318933837)
                 :HPT #S(EDWARDS-ECC:ECC-PT :X 2122072286167400037617870055143358993022067692402248913339665647642728584755
                                            :Y 2805863528993698854710678626884062198273121511366194646718224499200370985310)
                 :GS #(#S(EDWARDS-ECC:ECC-PT :X 3427316457148321844028076194714946371179622732616634040201790844164799249034
                                             :Y 3592532073720396585285547013195747123469065656116823302504062936867677839379)
                       #S(EDWARDS-ECC:ECC-PT :X 1781833810245491911596462435992348989857962213173079915587549375700438907062
                                             :Y 2959416283249882531533624095145858039537265214119505576252567944976433679388)
                       #S(EDWARDS-ECC:ECC-PT :X 740346677273179415394478618332964771283247428102236343031613925359370523842
                                             :Y 1258810931087026487249798652116420314294085998963998479767237571869492836364)
                       #S(EDWARDS-ECC:ECC-PT :X 658342464845260786324912185158272250999211512014131627398227642204281801934
                                             :Y 2690354842276015940419129483827062273888515973739489773625739537531823820884)
                       #S(EDWARDS-ECC:ECC-PT :X 3398778094221579930645130641965563799940983824661111930583277686892090849688
                                             :Y 838236297115799666013296977992336846825308025366437635706165416406973927160)
                       #S(EDWARDS-ECC:ECC-PT :X 2190523024754727325724949789979232225850745400847323639592351874942641665301
                                             :Y 1924674992749230274832872007313255685541475504065886207445603850929811081316)
                       #S(EDWARDS-ECC:ECC-PT :X 2300665841731723862931492629288339414675544875624647807145640216147694844161
                                             :Y 3535766496787222305136024924685633259503184721517173413474691675649872767406)
                       #S(EDWARDS-ECC:ECC-PT :X 3293075666022330497262285998513044715367139931543894032889154201203340121161
                                             :Y 2482043139751707369208866422185991126562882878399529444233273596799596831992)
                       #S(EDWARDS-ECC:ECC-PT :X 2859992311139022214981835977206756063663667353959513149992765499296269149597
                                             :Y 2448086921049080111909264867432051122311308803726176678526043046835532043656)
                       #S(EDWARDS-ECC:ECC-PT :X 2877393368738442463717272041681981631285730869907701047114335469402470864108
                                             :Y 227561516111267674005843209009440952557845427033487180437401193167582006737)
                       #S(EDWARDS-ECC:ECC-PT :X 3463679352870105742614345391373172162321433020751917222059645861604436560666
                                             :Y 111206723069812277077598744937977659156698739799198124608542262307254993945)
                       #S(EDWARDS-ECC:ECC-PT :X 144960195249600705817393188812836977072796586168078212059007690496957049328
                                             :Y 573487283559124255027592516247838997935520408054272723905137560928691541165)
                       #S(EDWARDS-ECC:ECC-PT :X 1206474505573005123769181505523090224374374378428541717622806721777706361728
                                             :Y 2147075954885597028267200225952325330405861670889581527864883822416824177642)
                       #S(EDWARDS-ECC:ECC-PT :X 37266796690232003098465993415206783159763950849892628668453152980389941143
                                             :Y 1515990179664503246254188321388767186650502317288680607036829709018962750537)
                       #S(EDWARDS-ECC:ECC-PT :X 2169927537346103721770950375356848756766936664646122694117358187098295196365
                                             :Y 2820625358670815318572092665284070480650405690495641786384119570013673528701)
                       #S(EDWARDS-ECC:ECC-PT :X 1965888358872166896369956412877353837862940198868458637415700108952162251074
                                             :Y 2362365845260667787817270437057971932830627491391771842186192669364497806860)
                       #S(EDWARDS-ECC:ECC-PT :X 1477414227795086229691932296333764155164232262267398812002573567048377427391
                                             :Y 2749285057930146189505666172757948279729790532679928966964555189523254065878)
                       #S(EDWARDS-ECC:ECC-PT :X 217425947866152518074075421884403994159378550718484085690885410815592989698
                                             :Y 2960534629111822279814682791367081421533604928424027669878976773532947990214)
                       #S(EDWARDS-ECC:ECC-PT :X 529057655753569138905453158175108984540745490434679084008057810130823990081
                                             :Y 3202121338392382119423479105861478429932182867291177065998730013529232096713)
                       #S(EDWARDS-ECC:ECC-PT :X 3599574549715705665133588531672924734653211474853316128283029153512813756144
                                             :Y 3146387304596933640753197540393313144389223521671647701167179009077939841566)
                       #S(EDWARDS-ECC:ECC-PT :X 886273316707129577611724895650110200480010420094861723186440733111001949881
                                             :Y 1296761150241183387680624013637625878200348688147573088522240952148025727802)
                       #S(EDWARDS-ECC:ECC-PT :X 1223691088998397697577737396270876640751228484101133949977905524586656295189
                                             :Y 2106546869422791436445084161178754518526638288733640611951237355573274464660)
                       #S(EDWARDS-ECC:ECC-PT :X 47495256368621845080831296186856804569006748684147815084473297924257223253
                                             :Y 2092216840751400445870864340902011052267634847004367244970639892336889229651)
                       #S(EDWARDS-ECC:ECC-PT :X 757366360552554627930652427612716741100344241065450360195153032124064065820
                                             :Y 1531345714650235165512011899501315814233850942736130771912443010339012185426)
                       #S(EDWARDS-ECC:ECC-PT :X 1068494654174266497392256769123749760220324069795386666687897268088954929987
                                             :Y 3310850506205854001560968010958952381598174216900942321936165187762712823459)
                       #S(EDWARDS-ECC:ECC-PT :X 1495939669394319098560174984262299480515794973223032688516767397057464667957
                                             :Y 3084500566311010582992460065127336287395030837452397380062399508714754243754)
                       #S(EDWARDS-ECC:ECC-PT :X 2280703588538017492486978432008141350393844150375848588990134923943811063112
                                             :Y 715448767150362981581248094826960178143772040362914223297263868975426008094)
                       #S(EDWARDS-ECC:ECC-PT :X 1316325103730820912148104922378874094766497633221986790882018413070635801742
                                             :Y 2281678486756643385778464939878864666495025291655231009481527084596085279717)
                       #S(EDWARDS-ECC:ECC-PT :X 2313844146934224690120266003782055820214163009357959950829986236575892465374
                                             :Y 3091518357490568618945328784407574934020359658215005815433780279157636627129)
                       #S(EDWARDS-ECC:ECC-PT :X 3269508686905118397040501548572374571390916212620780458448863604476556089538
                                             :Y 835931743075116172952213479406503890375834844286601669423417093556219314996)
                       #S(EDWARDS-ECC:ECC-PT :X 3389314995678516496832693498676303744159144575828618909199414623008388806545
                                             :Y 811445069955308426152142650340087893582604138442944399830857066638009557905)
                       #S(EDWARDS-ECC:ECC-PT :X 3605884642457857668158982527166051565680921878547812189767051963615915350989
                                             :Y 3521190676199120053315019867395028705886595338357887055854555041186328354951)
                       #S(EDWARDS-ECC:ECC-PT :X 3048430685257002087388816101468320388505686080346546607578268577907265612639
                                             :Y 2858609473358337580308261540057558433013316159174686249320943374636578632413)
                       #S(EDWARDS-ECC:ECC-PT :X 2976481188396071016689130345243197195050477438525099189119740310839598511789
                                             :Y 2078090349520258621161982492047080415046566158004211613855406693737452576348)
                       #S(EDWARDS-ECC:ECC-PT :X 2312238343174801114183854926057834501102983440959263632955965432741291541393
                                             :Y 3091645865714135494407603876698550490862539221797016235997716258891258258295)
                       #S(EDWARDS-ECC:ECC-PT :X 309168918423374892418946536843208463619564446773193430156744162108828774105
                                             :Y 2123055204009109176453823765632161108917459461368405898656386847013664754001)
                       #S(EDWARDS-ECC:ECC-PT :X 691614641573709305623558809646581337823261167665778954668155675617459251668
                                             :Y 1604709611419826781150001487359104319577867762489786900039635021262110168756)
                       #S(EDWARDS-ECC:ECC-PT :X 3201425780972158670007863176523114297104836405121897461650909905346846069308
                                             :Y 792704205834245230051320390992885049540590759684229037010589988612717600041)
                       #S(EDWARDS-ECC:ECC-PT :X 186633496875058602763948544722720708942731834100386654557260191742025736406
                                             :Y 1855519982247728815006985237569112789841662769045111054008223355547205461474)
                       #S(EDWARDS-ECC:ECC-PT :X 31435979844426274049049910503022529617624772679691440088026705530498571345
                                             :Y 811001250781946896851293394801065851045786931966216607328226339984718470141)
                       #S(EDWARDS-ECC:ECC-PT :X 2870570292191901765469985141972768301790843813867641822851957767007156914750
                                             :Y 448645106178462597192461510724839526615548267532877768818981551644629501542)
                       #S(EDWARDS-ECC:ECC-PT :X 2191694318216937781123880263074505292183435908050002363924539923500665837902
                                             :Y 2664202581001966521604257070674631652429494117378508694240322379420152952175)
                       #S(EDWARDS-ECC:ECC-PT :X 1712502029066245117112483456158767023573834786905607594689463434787778886386
                                             :Y 2207579935557125224219494822064582236177267326468106350181407101392403347754)
                       #S(EDWARDS-ECC:ECC-PT :X 1300577934839066338224316172189119610169974445181618639291971389832592351215
                                             :Y 48419368760827556117642212084477116535903742725576732061759329940077214562)
                       #S(EDWARDS-ECC:ECC-PT :X 298927251553695851051283930395855676592054710463703527336828513959510071654
                                             :Y 3564102703678455484053131414370659277525431627751428339113606892736951298548)
                       #S(EDWARDS-ECC:ECC-PT :X 2050169132685594622462042670402204450937126096846345753307582004973718861404
                                             :Y 1988413099647451676900159989606410348481023056861083519702596904720344595489)
                       #S(EDWARDS-ECC:ECC-PT :X 3478438672779766001681888721889647049204372383657744310544965970231422959643
                                             :Y 432315600217263874493398091276263709168867550512101723031150415162110981812)
                       #S(EDWARDS-ECC:ECC-PT :X 3604414109032646066957404209894304431909288670689354208597933023448613244145
                                             :Y 150841904317459015932514089202723518302675389987568323189200469308161983694)
                       #S(EDWARDS-ECC:ECC-PT :X 2784339290302033342568318210745747102267781378048278743182914104197445859520
                                             :Y 714563866648341915483561168175182706637237139928597029943389292183019998298)
                       #S(EDWARDS-ECC:ECC-PT :X 3061209668165186897937788020460419930813188323099879377245847084074256668908
                                             :Y 1681098525550932023129117498527762031523607744412549964304381925354881441410)
                       #S(EDWARDS-ECC:ECC-PT :X 508944365348827279295909608802645742631099731184211916550269650762296000192
                                             :Y 3205629581676342652880073984927527883449765521781144985952391187360343305872)
                       #S(EDWARDS-ECC:ECC-PT :X 1333988324700366658894494308717408932778602877239463323753319872685789914620
                                             :Y 879730315974643177418360114698667435175645974703569853835590783556250857835)
                       #S(EDWARDS-ECC:ECC-PT :X 2454633175601743717023562376289106267308241906803776335387925559950245525039
                                             :Y 3127125296834760218672381018743733657852328957425798761009321330597929834477)
                       #S(EDWARDS-ECC:ECC-PT :X 2804599056318878672209234784228875084199018803673425390351075089823191179429
                                             :Y 790445860469673096261400259723529275389125969022673857389492278019499376622)
                       #S(EDWARDS-ECC:ECC-PT :X 1984225281597234087217911579263668009991493534732256110789387394480932622762
                                             :Y 3056796479283724100176748669248719614637038137594421155855593125498001860113)
                       #S(EDWARDS-ECC:ECC-PT :X 1925938881038180767608665452068261033008304609246763130726564936588659595289
                                             :Y 2546638472492136073472894665669682081102101551831509457302864111561315326123)
                       #S(EDWARDS-ECC:ECC-PT :X 309934169210213380778949190788841993796873885243518632232904388173765397440
                                             :Y 2872212696381654687142015065644383099197535692232117354358778330134461400439)
                       #S(EDWARDS-ECC:ECC-PT :X 2075671399140132639350511485234232965287625339337405568100388422324309778882
                                             :Y 940463771962558828783717231618563796364774000036666681511856398229679834050)
                       #S(EDWARDS-ECC:ECC-PT :X 1624420281730107732882977942248135810931857385908300141048126657777786314353
                                             :Y 2756753552774448583307640852373471081355797273245053920860376082373902464639)
                       #S(EDWARDS-ECC:ECC-PT :X 615744935068846924309953406394263386177086187016581519867670991838387195808
                                             :Y 2958464128230078079840643299218043848974803198608047629010907711727933074784)
                       #S(EDWARDS-ECC:ECC-PT :X 1154731522903184948714539256213318885668193116245929316429473347477671236146
                                             :Y 51486143860462552793177031724887438192528699273920251104651465750918649311)
                       #S(EDWARDS-ECC:ECC-PT :X 2583818334193733279620674434712971283402778605317300261706781245471134700504
                                             :Y 662988243384611110875344152804947872345950619509145077405610739610465905486)
                       #S(EDWARDS-ECC:ECC-PT :X 1081418610713591907024343491437212304373055312657280632372977716498707499715
                                             :Y 259958877284705836347817814864329907994188717882695225760347551899807530270)
                       #S(EDWARDS-ECC:ECC-PT :X 846477855945803105047778283757803955767660889366792397188924133413341023580
                                             :Y 2604986035967471630577660084821205407616915890990348879825563506681564787494))
                 :HS #(#S(EDWARDS-ECC:ECC-PT :X 3328711232989921072106780693849732215799826729900536726490003410620417140422
                                             :Y 188777143820246565137411423052659337266472951920776212036460729814735048330)
                       #S(EDWARDS-ECC:ECC-PT :X 555216694029283835617378872155748522176599497735402874794250193695598051586
                                             :Y 1349390909166253230056138882536620305965265748321687773178077559714010939670)
                       #S(EDWARDS-ECC:ECC-PT :X 831498315194194190784752439570821585812664720762594696504567206601975140661
                                             :Y 2680352241678553769368290896438653524400940439989334525721358355290152096)
                       #S(EDWARDS-ECC:ECC-PT :X 1533847469959471548396007379286363891273198701699098844349538621992364249059
                                             :Y 2451940628647237586509629262772460377462887859666124082531089727864964815834)
                       #S(EDWARDS-ECC:ECC-PT :X 1029086939134782131551124058277422000117925081354403459232626131673018795513
                                             :Y 1383660169366163537051654965592299563805818637269499013085664208601796712797)
                       #S(EDWARDS-ECC:ECC-PT :X 194345857785177033686024643012144202763972841238866283640036066113971788216
                                             :Y 2054950223747015919599352991825353939871954464399154688684246258371584281786)
                       #S(EDWARDS-ECC:ECC-PT :X 1985172415145238345592487903901007644524713157044180889026492895992995685725
                                             :Y 2779603796237624960265172955180635731094193523952252131572868690329180789004)
                       #S(EDWARDS-ECC:ECC-PT :X 335091401380544912926915394580340538365408860739072390593282318734799980840
                                             :Y 3285804038813353466898240723654727173702712849710987976720859889439971795917)
                       #S(EDWARDS-ECC:ECC-PT :X 2926930269202693401005953529722907669570868469035076183310679740539775513004
                                             :Y 804254677134894118289351980357321128148882770629748910866598990663676752997)
                       #S(EDWARDS-ECC:ECC-PT :X 1922081242240295146124812149904349662548194788294906134015609422118911069799
                                             :Y 282320809035364545717107111864416535337900465428069360448558848444245059659)
                       #S(EDWARDS-ECC:ECC-PT :X 2440608491187014234173064409557722152183076198831710788888162852352349099380
                                             :Y 1595457313243318271991146155770109762340034240526817949618236462214585990805)
                       #S(EDWARDS-ECC:ECC-PT :X 361445346997917186027551314138418703356383766538695224685040692095975446657
                                             :Y 1559103851071155548674715954241329049226734606798954210842110213514986839718)
                       #S(EDWARDS-ECC:ECC-PT :X 3179186206291735542686899774382988835733580691712897646492667985640832756783
                                             :Y 1811699601759208007938726054146639498090400227589060761371415056470473380343)
                       #S(EDWARDS-ECC:ECC-PT :X 1856194793627559366286959591480110159329644569046176459178948982527332123467
                                             :Y 929855793998620270477882292851453063812313288871500664262555137794344308411)
                       #S(EDWARDS-ECC:ECC-PT :X 2314121520295761120437622283445711825716725829020920754929524449192279881963
                                             :Y 1623648292253501416210893992463669672444427494502214811319628982994106640294)
                       #S(EDWARDS-ECC:ECC-PT :X 935296698496363063458752311681696595982011745524342029595658890553606962178
                                             :Y 638912384569405940774327061995564346230318491110402356428637429012289000240)
                       #S(EDWARDS-ECC:ECC-PT :X 3341927333122495725176741703077805415937932900119153831797508660537797494887
                                             :Y 2484917742579093685499685754139570089495597807282927086561196282833202780352)
                       #S(EDWARDS-ECC:ECC-PT :X 1123708633560256674748503604005985955438177145092215005044846829923929140079
                                             :Y 1714942658002929966981094242905283245829512404579617431273341575099431932554)
                       #S(EDWARDS-ECC:ECC-PT :X 3360456003218018040986788201857036060194597427187661713095477231193492974711
                                             :Y 1329143100914096963322671703953047273882706505123111617143118353386684010459)
                       #S(EDWARDS-ECC:ECC-PT :X 2337896859553384369066906072356584787198058289374124446657226532768766783131
                                             :Y 626341793144656013452459561003253915348740282239514424521378028252067699692)
                       #S(EDWARDS-ECC:ECC-PT :X 3308695454738405034706615153247468417324035093800388203300933056767764877770
                                             :Y 2318309177892919512547008949545893030509268296474486593371296930590735422950)
                       #S(EDWARDS-ECC:ECC-PT :X 2293743899757800903504975227817877701223097081832420989584487355384980003853
                                             :Y 1416789775247253695279884539408702613574534539624599277739763751612647658818)
                       #S(EDWARDS-ECC:ECC-PT :X 378803697531754029159314131262620930623406188273992819262045791796162628088
                                             :Y 2997502389059690242003103987969351508198845791820017822747075054589316048094)
                       #S(EDWARDS-ECC:ECC-PT :X 3566279452956638945921620678883029682667222363648977955751381078356327610765
                                             :Y 1740999604988788525769798440832544825509109706022842943756890493110342191588)
                       #S(EDWARDS-ECC:ECC-PT :X 1559806548362003052001872157896239698427238552126991652395534883078232550513
                                             :Y 440039825636677537855045368704928112592448391127385585218452881527552477462)
                       #S(EDWARDS-ECC:ECC-PT :X 1991485815831884569079860852085643512559625336898180265078994710663857289656
                                             :Y 2476610126035761434002059063078517283346894821303628796798232421956978294474)
                       #S(EDWARDS-ECC:ECC-PT :X 3345114902825394844865875868789660236815684880616280334790487452017887221621
                                             :Y 3386066353622907690788610752575812620045774217289809274646926182616782842321)
                       #S(EDWARDS-ECC:ECC-PT :X 1866214531262672177940140446556305017797556032296104828310775936893946392041
                                             :Y 1999184737917376212534916584722730233508004355732275801663132379984610450694)
                       #S(EDWARDS-ECC:ECC-PT :X 1336592671703167292750630077484829493153467234795212091969772398107218646509
                                             :Y 2282960535831358160359856127136732552817656166914847355798323642675539775016)
                       #S(EDWARDS-ECC:ECC-PT :X 1205679344099112955626629101624032050206126588654564581976488900841033413310
                                             :Y 1072101736770208651220401306679162076897551639456107321857842694710106653238)
                       #S(EDWARDS-ECC:ECC-PT :X 2010602905938476366155459489623466105896199990356946915791860959892104475321
                                             :Y 2363660668908784535686607545882570768812157890560856860526853678976007230400)
                       #S(EDWARDS-ECC:ECC-PT :X 1400577063989136989315750755032507189448131519896012205463093795952464609669
                                             :Y 491997551831912853361853304748393509258456641375551760694688383187150484543)
                       #S(EDWARDS-ECC:ECC-PT :X 256908193895831645517993604806604240545593074609568465365555758887905591148
                                             :Y 824358898111941024660591225067071304144297762083218280177899656473371361467)
                       #S(EDWARDS-ECC:ECC-PT :X 1384569516564081946751860547498378445557511330946180680814308274393959926166
                                             :Y 663317103935805485642703382951576838154759858048584500662792300840454452542)
                       #S(EDWARDS-ECC:ECC-PT :X 545439095759613723111788849675691499917901026528831940627958454723167966906
                                             :Y 975328840702348539841149847761813254158015626449119951567409138607748790273)
                       #S(EDWARDS-ECC:ECC-PT :X 2685805038565125172357127522741687579529985064259983118849651057438260396547
                                             :Y 3433343094186105817591543121749276647450579493078158220419200907065536071721)
                       #S(EDWARDS-ECC:ECC-PT :X 741743173898475295749515420926878920586302441565731034332384287291911616489
                                             :Y 1675178378264728092409392288108691864181285093179082048751154892621261159003)
                       #S(EDWARDS-ECC:ECC-PT :X 629860879309665222505393323078438910923249229875726873624353875810182709075
                                             :Y 81770608399371271051606157466237731428070693298425863718711400497591837829)
                       #S(EDWARDS-ECC:ECC-PT :X 3243607764037269843208620072884966206664102916913888413990477516977670093696
                                             :Y 265721766372821248237727738593729210061649300354978071622269932419320776936)
                       #S(EDWARDS-ECC:ECC-PT :X 2228222149436425094176262997185849447167449477433756038593255915781271730860
                                             :Y 1782248309145560496281255459277920032783002035545613762901926457907827127656)
                       #S(EDWARDS-ECC:ECC-PT :X 3408873567956157807690606729491911223911461413053983285921411970863556762511
                                             :Y 770505578612537191266974644921358059344114514073150794149954195736104795466)
                       #S(EDWARDS-ECC:ECC-PT :X 2752202581699314554128718319250679740916968573178745497696846078773785871340
                                             :Y 214666976715818014227267413936128337473338210843609078217669629074080434855)
                       #S(EDWARDS-ECC:ECC-PT :X 624672643020801089746287309657807132807290186168263253612387344319765069925
                                             :Y 808956489753054241510495065951036231664516029424352267675227146251032361159)
                       #S(EDWARDS-ECC:ECC-PT :X 793365297428906780498349443901252698355639397232859634853362120691894691321
                                             :Y 866921666018338885370002996613395661852362451779393173823222322322088731613)
                       #S(EDWARDS-ECC:ECC-PT :X 172980192383501645416877840155144958024819862010435075813151064504917592104
                                             :Y 3405596460423220442147824471428769942078312479676472660295446232888668754255)
                       #S(EDWARDS-ECC:ECC-PT :X 993976049255664905214283483539757563661173044342214252698611147603718265983
                                             :Y 7739536640384891556200354977974085586853141394849509208511035807803885405)
                       #S(EDWARDS-ECC:ECC-PT :X 2017601863012800044948191130498500381674456766038013612465128054200448890149
                                             :Y 3051322303465953523679777643356404600838017139770041189624421351239555552051)
                       #S(EDWARDS-ECC:ECC-PT :X 925029452936059921274670535485751089447006472577806305073669328303571698538
                                             :Y 750817057965917171621394766964394625065803053748322579238848646159285596892)
                       #S(EDWARDS-ECC:ECC-PT :X 123063587280590393984519933361476053764071147554655275269782442440521805926
                                             :Y 1129390100369133854925590268357990234125613420353174490712851743618483411610)
                       #S(EDWARDS-ECC:ECC-PT :X 1478773303706444493361363922157436342112574614437239683345811943201238503617
                                             :Y 1679211570188854173017607495772562394940032686589933591710155227323498967521)
                       #S(EDWARDS-ECC:ECC-PT :X 2575522516309355419340756901957725378932043388412755556267364743985796690943
                                             :Y 1878822228256670714897936978162993251264947045413771536554894735721611741798)
                       #S(EDWARDS-ECC:ECC-PT :X 2326568167220424031816026118453719095012365210580636454087053727078477973077
                                             :Y 2729417413322674072118723928658461097279103193830662123971444913697224083344)
                       #S(EDWARDS-ECC:ECC-PT :X 407713849409433633752535916271500136722445138018906152255320769479219073965
                                             :Y 2889182014315145731803470433418117797735037769577000024631051920472014575757)
                       #S(EDWARDS-ECC:ECC-PT :X 138194366908803352900562982013106381489927882934847678894706896178975400516
                                             :Y 680605781133928401241924404300850086111192763000482709621473094777046771914)
                       #S(EDWARDS-ECC:ECC-PT :X 2792335433295930643073737821365164302975288390046864606152864905149057994604
                                             :Y 2060692087996427922963822445583074465217441701821318891770636444629560266650)
                       #S(EDWARDS-ECC:ECC-PT :X 3437237920506585605209168026054941641171570250930815946335248495455408753208
                                             :Y 2649433828876427985902007987636912577205268442825941338328284800520390269539)
                       #S(EDWARDS-ECC:ECC-PT :X 2739721031767869381861648020577793474953551830130874383443316817106769133216
                                             :Y 2003146897158015800873524600008299957988814926671268089000909211705192904535)
                       #S(EDWARDS-ECC:ECC-PT :X 2188084857559979219994254098499586276266011251389414850328963786633648252810
                                             :Y 619972703449665861794371179781742821812672552836502321145701699126464273545)
                       #S(EDWARDS-ECC:ECC-PT :X 1062351523907545285805014826052088943923414832464191083147489188384277183442
                                             :Y 599045151117103954547629822050687317803195521524920513608047365329532282103)
                       #S(EDWARDS-ECC:ECC-PT :X 479862850744722676637633212943949041872879034914897085876519826772275150666
                                             :Y 275613978771588851859415840947119782648846217850093471687587966293991324157)
                       #S(EDWARDS-ECC:ECC-PT :X 1207998296509055190910686390682924903798341258899203095576529685925980248562
                                             :Y 390826172004181733239693743288474198933498887990580050116976929338944136742)
                       #S(EDWARDS-ECC:ECC-PT :X 587074387978074958466234489317466768389790064401840069886659014006594166844
                                             :Y 2266927684257653649132372526674786322026867584776133233903614730128604074047)
                       #S(EDWARDS-ECC:ECC-PT :X 1616212946218332529689380855848019188491704587934881544447623416020879381087
                                             :Y 1255304377476724239568867223886149561835560890431186983151273673515653378276)
                       #S(EDWARDS-ECC:ECC-PT :X 1176701135021625290754818341282848196546946314546429101272041675281401152554
                                             :Y 1192414316178923842504286462156379270382514285232110100597463582941140588448)
                       )))

(defvar *chk-bp-basis*
  ;; = (hex-str (HASH/256 *bp-basis*))
  "EA28D0212180691D9A50C07BC822C582BDEDA20857F2C241CA08B55EBDC701F9")
|#

;; --------------------------------------------------------------------------------

(defvar *gs*   nil)
(defvar *hs*   nil)
(defvar *gpt*  nil)
(defvar *hpt*  nil)

(defun init-basis (&key (nbits *max-bit-length*)
                        (curve (ed-curve-name *edcurve*)))
  (labels ((gen-basis ()
             (destructuring-bind (gpt hpt &rest pts)
                 (if (or (eql :Curve-Ed3363 curve)
                         (eql :Curve1174 curve))
                     (mapcar 'ed-affine (basis-pts nbits))
                   (basis-pts nbits))
               (make-bp-basis
                :curve  curve
                :nbits  nbits
                :gpt    gpt
                :hpt    hpt
                :gs     (coerce (subseq pts 0 nbits) 'vector)
                :hs     (coerce (subseq pts nbits) 'vector)))))
    
    (cond (*bp-basis*
           (cond ((eql curve *curve*)
                  (cond ((= nbits *nbits*)
                         *bp-basis*)

                        ((< nbits *nbits*)
                         (make-bp-basis
                          :curve  curve
                          :nbits  nbits
                          :gpt    *bgpt*
                          :hpt    *bhpt*
                          :gs     *bgs*
                          :hs     *bhs*))

                        (t
                         (gen-basis))
                        ))
                 (t
                  (gen-basis))
                 ))
          
          (t
           (setf *bp-basis* (gen-basis)))
          )))

(defun do-with-basis (basis fn)
  (let ((*bp-basis*  basis))
    (with-ed-curve *curve*
      (with-mod *ed-r*
        (let* ((*gpt*  *bgpt*)
               (*hpt*  *bhpt*)
               (*gs*   *bgs*)
               (*hs*   *bhs*))
          (funcall fn))))))

(defmacro with-basis (basis &body body)
  `(do-with-basis ,basis
                  (lambda ()
                    ,@body)))

#+:LISPWORKS
(editor:setup-indent "with-basis" 1)

;; ---------------------------------------------------------------------

(defun make-range-proofs (&key (nbits *max-bit-length*)
                               vals)
  (with-basis (init-basis :nbits nbits)
    (let* ((prover (make-range-prover))
           (proofs nil)
           (gammas nil))
      (dolist (val vals)
        (multiple-value-bind (proof gamma)
            (funcall prover val)
          (push proof proofs)
          (push gamma gammas)))
      (let* ((sum-cmt (reduce 'ed-add
                              (mapcar (um:compose 'ed-decompress-pt 'range-proof-vcmt) proofs)
                              :initial-value (ed-neutral-point)))
             (sum-gamma (reduce 'm+ gammas)))
        (make-range-proof-block
         :basis     *bp-basis*
         :proofs    (nreverse proofs)
         :sum-cmt   (ed-compress-pt sum-cmt)
         :sum-gamma sum-gamma)
        ))))

(defmethod validate-range-proofs ((proof-block range-proof-block))
  (with-basis (range-proof-block-basis proof-block)
    (every 'internal-validate-range-proof (range-proof-block-proofs proof-block))))

;; -------------------------------------------------------------------
;; Transaction support -- fixed basis

(defmethod make-range-proof (val &key (gamma (rand-val)))
  (with-basis (init-basis :nbits *max-bit-length*)
    (let ((prover (make-range-prover)))
      (funcall prover val gamma))))

(defmethod validate-range-proof ((prf range-proof))
  (with-basis (init-basis :nbits *max-bit-length*)
    (internal-validate-range-proof prf)))

(defmethod proof-simple-commitment ((proof range-proof))
  "This is the item used to form the hash-lock on a send in a
transaction. Hash this value with the public key of the recipient to
lock it to the recipient."
  (range-proof-vcmt proof))

(defun gpt ()
  "Return the *gpt* curve point used to make Pedersen commitments"
  *bgpt*)

(defun hpt ()
  "Return the *hpt* curve point used to make Pedersen commitments"
  *bhpt*)

;; ------------------------------
;; Construct a range-prover for use on multiple values

(defun make-range-prover ()
  
  ;; let's compute the basis vectors just once, and share them
  (labels
      ;; ---------------------------------------------
      ((make-range-proof (v &optional (gamma (rand-val)))
         (check-type v     (integer 0))
         (check-type gamma (integer 1))
         (assert (<= 0 v (1- (ash 1 *nbits*))))
         (let* ((vcmt       (simple-commit *gpt* *hpt* gamma v))
                (vcmt-cmpr  (ed-compress-pt vcmt))
                
                (a_l        (bits-vector v *nbits*))
                (a_r        (vec-decr a_l 1))
                (alpha      (rand-val))
                (acmt       (vec-commit *hpt* alpha *hs* a_r *gs* a_l))
                (acmt-cmpr  (ed-compress-pt acmt))
                
                (s_l        (random-vec *nbits*))
                (s_r        (random-vec *nbits*))
                (rho        (rand-val))
                (scmt       (vec-commit *hpt* rho *hs* s_r *gs* s_l))
                (scmt-cmpr  (ed-compress-pt scmt))
                
                ;; publish Acmt, Scmt
                
                (y          (int (hash/256 vcmt-cmpr acmt-cmpr scmt-cmpr)))
                (z          (int (hash/256 y)))
                
                (poly_l0    (vec-decr a_l z))
                (poly_l1    s_l)
                (poly_l     (vector poly_l0 poly_l1))
                
                (yvec       (pow-vec y *nbits*))
                (zsq        (m* z z))
                (poly_r0    (vec-add
                             (vec-hadamard-prod yvec
                                                (vec-incr a_r z))
                             (vec-scale (twos-vec *nbits*) zsq)))
                (poly_r1    (vec-hadamard-prod yvec s_r))
                (poly_r     (vector poly_r0 poly_r1))              
                
                (poly_t     (poly-dot-prod poly_l poly_r))
                (t1         (aref poly_t 1))
                (t2         (aref poly_t 2))
                
                (tau1       (rand-val))
                (tau2       (rand-val))
                
                (t1cmt      (simple-commit *gpt* *hpt* tau1 t1))
                (t1cmt-cmpr (ed-compress-pt t1cmt))
                (t2cmt      (simple-commit *gpt* *hpt* tau2 t2))
                (t2cmt-cmpr (ed-compress-pt t2cmt))
                
                ;; publish T1cmt, T2cmt
                
                (x          (int (hash/256 t1cmt-cmpr t2cmt-cmpr)))
                (lvec       (vec-add poly_l0 (vec-scale poly_l1 x)))
                (rvec       (vec-add poly_r0 (vec-scale poly_r1 x)))
                (t_hat      (vec-dot-prod lvec rvec))
                (tau_x      (vec-dot-prod (pow-vec x 3)
                                          (vector (m* gamma zsq) tau1 tau2)))
                (mu         (m+ alpha
                                (m* rho x)))
                
                ;; publish tau_x, mu, t_hat, lvec, rvec
                )
           (values
            (%make-range-proof
             ;; commitments
             :vcmt  vcmt-cmpr
             :acmt  acmt-cmpr
             :scmt  scmt-cmpr
             :t1cmt t1cmt-cmpr
             :t2cmt t2cmt-cmpr
             ;; parameters
             :tau_x tau_x
             :mu    mu
             :t_hat t_hat
             :dot-proof (make-lr-dot-prod-proof y mu t_hat lvec rvec)
             ;; challenge values x, y, z
             :x     x
             :y     y
             :z     z)
            gamma)
           )))
    
    ;; ---------------------------------------------------
    #'make-range-proof))

;; ---------------------------------------------------------------------
;; Range proof validation

(defun internal-validate-range-proof (proof)
  (let* ((nbits     *nbits*)
         (y         (range-proof-y proof))
         (yvec      (pow-vec y nbits))
         (z         (range-proof-z proof))
         (zsq       (m* z z))
         (x         (range-proof-x proof))
         (xsq       (m* x x))
         (delta     (m- (m* (m- z zsq)
                            (reduce 'm+ yvec))
                        (m* (1- (ash 1 nbits))
                            (m* z zsq))))
         (chck-v-l  (simple-commit *gpt* *hpt*
                                   (range-proof-tau_x proof)
                                   (range-proof-t_hat proof)))
         (vcmt      (ed-decompress-pt (range-proof-vcmt proof)))
         (t1cmt     (ed-decompress-pt (range-proof-t1cmt proof)))
         (t2cmt     (ed-decompress-pt (range-proof-t2cmt proof)))
         (chck-v-r  (ed-add (ed-mul vcmt zsq)
                            (ed-add (ed-mul *gpt* delta)
                                    (ed-add (ed-mul t1cmt x)
                                            (ed-mul t2cmt xsq))
                                    ))))
    (when (ed-pt= chck-v-l chck-v-r)
      (let* ((*hs*      (map 'vector 'ed-mul
                             *hs*
                               (pow-vec (m/ y) nbits)))
             (hpows     (vec-add (vec-scale yvec z)
                                 (vec-scale (twos-vec nbits) zsq)))
             (gpows     (vec-scale (ones-vec nbits) (m- z)))
             (acmt      (ed-decompress-pt (range-proof-acmt proof)))
             (scmt      (ed-decompress-pt (range-proof-scmt proof)))
             (chk-p-l   (ed-add acmt
                                (vec-commit scmt x
                                            *hs* hpows
                                            *gs* gpows)))
             (dot-proof (range-proof-dot-proof proof))
             (p         (ed-decompress-pt (dot-prod-proof-pcmt dot-proof))))
        
        (when (ed-pt= chk-p-l p)
          (fast-validate-dot-prod-proof dot-proof))
        ))))

;; -----------------------------------------------------------

(defun make-lr-dot-prod-proof (y mu t_hat lvec rvec)
  ;; set up conditions for range proofs to provide Bulletproofs on
  ;; vector dot products
  (let* ((nbits (length lvec))
         (*hs*  (map 'vector 'ed-mul
                     *hs*
                     (pow-vec (m/ y) nbits)))
         (u     (ed-mul *hpt* (m/ mu t_hat)))
         (p     (vec-commit *hpt* mu
                            *hs*  rvec
                            *gs*  lvec)))
    
    (make-dot-prod-proof u p lvec rvec)))


(defun make-dot-prod-proof (u pcmt a b)
  ;; for input vectors a, b, commitment p, aux arg u
  ;; global basis vectors g, h, order n = length g
  ;; n should be pow2
  ;;
  ;; construct proof that c = <a b> and P = g^a h^b u^c
  ;;
  (um:nlet-tail iter ((n  (length a))
                      (g  *gs*)
                      (h  *hs*)
                      (p  pcmt)
                      (a  a)
                      (b  b)
                      (accum nil))
    (if (eql 1 n)
        (%make-dot-prod-proof ;; validate as P = g^a h^b u^(a*b)
                              :u    (ed-compress-pt u)
                              :pcmt (ed-compress-pt pcmt)
                              :a    (aref a 0)
                              :b    (aref b 0)
                              :xlrs (nreverse accum))
      ;; else
      (let* ((n/2  (ash n -1))
             (gl   (subseq g 0 n/2))
             (gr   (subseq g n/2))
             (hl   (subseq h 0 n/2))
             (hr   (subseq h n/2))
             (al   (subseq a 0 n/2))
             (ar   (subseq a n/2))
             (bl   (subseq b 0 n/2))
             (br   (subseq b n/2))
             (cl   (vec-dot-prod al br))
             (cr   (vec-dot-prod ar bl))
             (l    (vec-commit u cl
                               hl br
                               gr al))
             (r    (vec-commit u cr
                               hr bl
                               gl ar))
             ;; publish L,R
             (lcmpr (ed-compress-pt l))
             (rcmpr (ed-compress-pt r))
             (x     (int (hash/256 lcmpr rcmpr))) ;; challenge x
             
             (invx  (m/ x))
             (gp    (map 'vector
                         (lambda (ptl ptr)
                           (ed-add
                            (ed-mul ptl invx)
                            (ed-mul ptr x)))
                         gl gr))
             (hp    (map 'vector
                         (lambda (ptl ptr)
                           (ed-add
                            (ed-mul ptl x)
                            (ed-mul ptr invx)))
                         hl hr))
             
             (xsq    (m* x x))
             (xsqinv (m/ xsq))
             (pp     (ed-add
                      (ed-mul l xsq)
                      (ed-add p
                              (ed-mul r xsqinv))))
             
             (ap     (vec-add
                      (vec-scale al x)
                      (vec-scale ar invx)))
             (bp     (vec-add
                      (vec-scale bl invx)
                      (vec-scale br x))))
        
        (iter n/2 gp hp pp ap bp
              (cons (list x lcmpr rcmpr) accum)))
      )))

;; -------------------------------------------------------
#|
  ;; not needed with fast validation running properly...
(defun validate-dot-prod-proof (proof)
  (let* ((u         (ed-decompress-pt (dot-prod-proof-u proof)))
         (p         (ed-decompress-pt (dot-prod-proof-pcmt proof)))
         (a         (dot-prod-proof-a proof))
         (b         (dot-prod-proof-b proof))
         (xlrs      (dot-prod-proof-xlrs proof)))
    (um:nlet-tail iter ((gs   *gs*)
                        (hs   *hs*)
                        (p    p)
                        (xlrs xlrs))
      (if (endp xlrs)
          (ed-pt= p (ed-add
                     (ed-mul (aref gs 0) a)
                     (ed-add
                      (ed-mul (aref hs 0) b)
                      (ed-mul u (m* a b)))))
        ;; else
        (destructuring-bind (x lcmpr rcmpr) (first xlrs)
          (let* ((l    (ed-decompress-pt lcmpr))
                 (r    (ed-decompress-pt rcmpr))
                 (n/2  (ash (length gs) -1))
                 (gl   (subseq gs 0 n/2))
                 (gr   (subseq gs n/2))
                 (hl   (subseq hs 0 n/2))
                 (hr   (subseq hs n/2))
                 (xsq  (m* x x))
                 (pp   (ed-add
                        (ed-mul l xsq)
                        (ed-add
                         p
                         (ed-mul r (m/ xsq)))))
                 
                 (invx  (m/ x))
                 (gp    (map 'vector
                             (lambda (ptl ptr)
                               (ed-add
                                (ed-mul ptl invx)
                                (ed-mul ptr x)))
                             gl gr))
                 (hp    (map 'vector
                             (lambda (ptl ptr)
                               (ed-add
                                (ed-mul ptl x)
                                (ed-mul ptr invx)))
                             hl hr)))
            (iter gp hp pp (cdr xlrs))))
        ))))
|#             
;; --------------------------------------------------------------

(defun compute-svec (xlrs nbits)
  (let ((svec (make-array nbits))
        (xs   (mapcar 'first xlrs)))
    (loop for ix from 0 below nbits
          do
          (setf (aref svec ix)
                (let ((prod 1))
                  (loop for jx from 0
                        for x in xs
                        do
                        (setf prod (m* prod
                                       (if (logbitp jx ix)
                                           x
                                         (m/ x)))))
                  prod)))
    svec))
  
(defun fast-validate-dot-prod-proof (proof)
  (let* ((nbits     *nbits*)
         (u         (ed-decompress-pt (dot-prod-proof-u proof)))
         (p         (ed-decompress-pt (dot-prod-proof-pcmt proof)))
         (a         (dot-prod-proof-a proof))
         (b         (dot-prod-proof-b proof))
         (xlrs      (reverse (dot-prod-proof-xlrs proof)))
         (sv        (compute-svec xlrs nbits))
         (svinv     (map 'vector 'm/ sv))
         (chk_l     (vec-commit u (m* a b)
                                *gs* (vec-scale sv a)
                                *hs* (vec-scale svinv b)))
         (chk_r     (reduce (lambda (ans triple)
                              (destructuring-bind (x lcmpr rcmpr) triple
                                (let ((xsq (m* x x))
                                      (l   (ed-decompress-pt lcmpr))
                                      (r   (ed-decompress-pt rcmpr)))
                                  (ed-add ans
                                          (ed-add
                                           (ed-mul l xsq)
                                           (ed-mul r (m/ xsq))))
                                  )))
                            xlrs
                            :initial-value p)))
    (ed-pt= chk_l chk_r)))

;; ----------------------------------------------------------------------
;; test it out
#|
(defun tst (nbits &rest vals)
  (let* ((proofs (apply 'make-range-proofs nbits vals)))
    (assert (validate-range-proofs proofs))
    proofs))

(defun timing-test (&optional (niter 10))
  (let* ((vals   (loop repeat niter collect (random-between 0 #.(ash 1 64))))
         (proofs (time (apply 'make-range-proofs 64 vals))))
    (assert (time (validate-range-proofs proofs)))
    proofs))

(progn
  (setf *bp-basis* nil)
  (with-ed-curve :curve1174
    ;; force init allocation of basis vectors
    (let ((prf (make-range-proof 123456789)))
      (time (loop repeat 10 do
                  ;; (make-range-proof 123456789)
                  (validate-range-proof prf)))
      )))

(let* ((bits '(251 382 414 521))
       (gen  '(3.6 6.2 7.1 11))
       (val  '(1.4 2.5 2.9 4.4)))
  (plt:plot 'timings bits gen
            :clear t
            :ylog  t
            :xrange '(200 600)
            :yrange '(1 15)
            :plot-joined t
            :symbol :circle
            :legend "Make BulletProof"
            :title  "Timings for BulletProofs vs Curve Size"
            :xtitle "Curve Size [bits]"
            :ytitle "Time per BulletProof [sec]")
  (plt:plot 'timings bits val
            :color :red
            :symbol :circle
            :plot-joined t
            :legend "Validate BulletProof"))
|#

